/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PMCPlugin
});
module.exports = __toCommonJS(main_exports);

// src/components/setting.ts
var import_obsidian4 = require("obsidian");

// src/components/tabs/google/types.ts
var DEFAULT_GOOGLE_SETTINGS = {
  clientId: "",
  accessToken: "",
  tokenExpiry: "unlimited",
  tokenExpiryDate: void 0,
  timeRange: 90
};
var TOKEN_EXPIRY_OPTIONS = {
  "1week": "1 Week",
  "1month": "1 Month",
  "3months": "3 Months",
  "6months": "6 Months",
  unlimited: "Unlimited (Until manually disconnected)"
};
var GOOGLE_OAUTH_CALLBACK_URL = "https://rajeevrajchal.github.io/pmc/oauth-callback";

// src/components/tabs/google/auth.ts
var import_obsidian = require("obsidian");
var GoogleAuth = class {
  /**
   * Initiate OAuth flow to connect to Google Calendar
   * @param clientId - OAuth 2.0 Client ID from Google Cloud Console
   */
  static initiateOAuthFlow(clientId) {
    if (!clientId || clientId.trim() === "") {
      new import_obsidian.Notice("Please configure Client ID first");
      return;
    }
    const authUrl = this.buildAuthUrl(clientId);
    new import_obsidian.Notice("Opening Google authentication...");
    window.open(authUrl, "_blank");
  }
  /**
   * Build the OAuth authorization URL
   */
  static buildAuthUrl(clientId) {
    const params = new URLSearchParams({
      client_id: clientId,
      redirect_uri: GOOGLE_OAUTH_CALLBACK_URL,
      response_type: "token",
      scope: this.SCOPES.join(" "),
      access_type: "online"
    });
    return `${this.OAUTH_URL}?${params.toString()}`;
  }
  /**
   * Disconnect from Google Calendar
   * Clears the stored access token
   */
  static disconnect() {
    new import_obsidian.Notice("Disconnected from Google Calendar");
  }
};
GoogleAuth.OAUTH_URL = "https://accounts.google.com/o/oauth2/v2/auth";
GoogleAuth.SCOPES = [
  "https://www.googleapis.com/auth/calendar.readonly",
  "https://www.googleapis.com/auth/calendar.events"
];

// src/components/tabs/google/calendar-api.ts
var import_obsidian2 = require("obsidian");
var GoogleCalendarAPI = class {
  /**
   * Fetch calendar events from Google Calendar
   * @param accessToken - OAuth access token
   * @param calendarId - Calendar ID (defaults to 'primary')
   * @param query - Search query for events
   * @param timeMin - Start time for events (ISO 8601)
   * @param timeMax - End time for events (ISO 8601)
   * @param maxResults - Maximum number of events to return
   * @returns Array of calendar events
   */
  static async fetchEvents(accessToken, calendarId = "primary", query, timeMin, timeMax, maxResults = 250) {
    try {
      const params = {
        singleEvents: "true",
        orderBy: "startTime",
        maxResults: maxResults.toString()
      };
      if (timeMin) {
        params.timeMin = timeMin;
      }
      if (timeMax) {
        params.timeMax = timeMax;
      }
      if (query && query.trim() !== "") {
        params.q = query;
      }
      const queryString = new URLSearchParams(params).toString();
      const response = await fetch(
        `${this.BASE_URL}/calendars/${calendarId}/events?${queryString}`,
        {
          headers: {
            Authorization: `Bearer ${accessToken}`,
            "Content-Type": "application/json"
          }
        }
      );
      if (!response.ok) {
        const errorText = await response.text();
        console.error("API Error Response:", errorText);
        throw new Error(`Failed to fetch events: ${response.statusText}`);
      }
      const data = await response.json();
      return data.items || [];
    } catch (error) {
      console.error("Error fetching calendar events:", error);
      new import_obsidian2.Notice("Failed to fetch calendar events");
      throw error;
    }
  }
  /**
   * Create a new calendar event
   * @param accessToken - OAuth access token
   * @param event - Event details to create
   * @param calendarId - Calendar ID (defaults to 'primary')
   * @returns Created event
   */
  static async createEvent(accessToken, event, calendarId = "primary") {
    try {
      const response = await fetch(
        `${this.BASE_URL}/calendars/${calendarId}/events`,
        {
          method: "POST",
          headers: {
            Authorization: `Bearer ${accessToken}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify(event)
        }
      );
      if (!response.ok) {
        throw new Error(`Failed to create event: ${response.statusText}`);
      }
      const createdEvent = await response.json();
      new import_obsidian2.Notice("Event created successfully");
      return createdEvent;
    } catch (error) {
      console.error("Error creating calendar event:", error);
      new import_obsidian2.Notice("Failed to create calendar event");
      throw error;
    }
  }
  /**
   * Update an existing calendar event
   * @param accessToken - OAuth access token
   * @param eventId - ID of the event to update
   * @param event - Updated event details
   * @param calendarId - Calendar ID (defaults to 'primary')
   * @returns Updated event
   */
  static async updateEvent(accessToken, eventId, event, calendarId = "primary") {
    try {
      const response = await fetch(
        `${this.BASE_URL}/calendars/${calendarId}/events/${eventId}`,
        {
          method: "PUT",
          headers: {
            Authorization: `Bearer ${accessToken}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify(event)
        }
      );
      if (!response.ok) {
        throw new Error(`Failed to update event: ${response.statusText}`);
      }
      const updatedEvent = await response.json();
      new import_obsidian2.Notice("Event updated successfully");
      return updatedEvent;
    } catch (error) {
      console.error("Error updating calendar event:", error);
      new import_obsidian2.Notice("Failed to update calendar event");
      throw error;
    }
  }
  /**
   * Delete a calendar event
   * @param accessToken - OAuth access token
   * @param eventId - ID of the event to delete
   * @param calendarId - Calendar ID (defaults to 'primary')
   */
  static async deleteEvent(accessToken, eventId, calendarId = "primary") {
    try {
      const response = await fetch(
        `${this.BASE_URL}/calendars/${calendarId}/events/${eventId}`,
        {
          method: "DELETE",
          headers: {
            Authorization: `Bearer ${accessToken}`
          }
        }
      );
      if (!response.ok) {
        throw new Error(`Failed to delete event: ${response.statusText}`);
      }
      new import_obsidian2.Notice("Event deleted successfully");
    } catch (error) {
      console.error("Error deleting calendar event:", error);
      new import_obsidian2.Notice("Failed to delete calendar event");
      throw error;
    }
  }
  /**
   * Get list of available calendars
   * @param accessToken - OAuth access token
   * @returns Array of calendar objects
   */
  static async listCalendars(accessToken) {
    try {
      const response = await fetch(`${this.BASE_URL}/users/me/calendarList`, {
        headers: {
          Authorization: `Bearer ${accessToken}`,
          "Content-Type": "application/json"
        }
      });
      if (!response.ok) {
        throw new Error(`Failed to fetch calendars: ${response.statusText}`);
      }
      const data = await response.json();
      return data.items || [];
    } catch (error) {
      console.error("Error fetching calendars:", error);
      new import_obsidian2.Notice("Failed to fetch calendars");
      throw error;
    }
  }
  /**
   * Sync calendar events (fetch and cache)
   * @param accessToken - OAuth access token
   */
  static async syncCalendar(accessToken) {
    try {
      new import_obsidian2.Notice("Syncing calendar...");
      const timeMin = (/* @__PURE__ */ new Date()).toISOString();
      const timeMax = new Date(
        Date.now() + 30 * 24 * 60 * 60 * 1e3
      ).toISOString();
      const events = await this.fetchEvents(
        accessToken,
        "primary",
        void 0,
        timeMin,
        timeMax
      );
      new import_obsidian2.Notice(`Synced ${events.length} events`);
      return;
    } catch (error) {
      console.error("Error syncing calendar:", error);
      new import_obsidian2.Notice("Failed to sync calendar");
      throw error;
    }
  }
};
GoogleCalendarAPI.BASE_URL = "https://www.googleapis.com/calendar/v3";

// src/components/tabs/google/settings-ui.ts
var import_obsidian3 = require("obsidian");

// src/components/tabs/google/token-manager.ts
var TokenManager = class {
  /**
   * Calculate token expiry date based on the selected option
   * @param expiryOption - The expiry option selected by the user
   * @returns Unix timestamp when token expires, or undefined for unlimited
   */
  static calculateExpiryDate(expiryOption) {
    if (expiryOption === "unlimited") {
      return void 0;
    }
    const now = Date.now();
    const millisecondsPerDay = 24 * 60 * 60 * 1e3;
    switch (expiryOption) {
      case "1week":
        return now + 7 * millisecondsPerDay;
      case "1month":
        return now + 30 * millisecondsPerDay;
      case "3months":
        return now + 90 * millisecondsPerDay;
      case "6months":
        return now + 180 * millisecondsPerDay;
      default:
        return void 0;
    }
  }
  /**
   * Check if the token has expired
   * @param expiryDate - Unix timestamp when token expires
   * @returns true if token is expired, false otherwise
   */
  static isTokenExpired(expiryDate) {
    if (!expiryDate) {
      return false;
    }
    return Date.now() >= expiryDate;
  }
  /**
   * Get human-readable time remaining until token expires
   * @param expiryDate - Unix timestamp when token expires
   * @returns Formatted string like "5 days", "2 hours", or "Unlimited"
   */
  static getTimeRemaining(expiryDate) {
    if (!expiryDate) {
      return "Unlimited";
    }
    const remaining = expiryDate - Date.now();
    if (remaining <= 0) {
      return "Expired";
    }
    const days = Math.floor(remaining / (24 * 60 * 60 * 1e3));
    const hours = Math.floor(remaining % (24 * 60 * 60 * 1e3) / (60 * 60 * 1e3));
    const minutes = Math.floor(remaining % (60 * 60 * 1e3) / (60 * 1e3));
    if (days > 0) {
      return `${days} day${days !== 1 ? "s" : ""}`;
    } else if (hours > 0) {
      return `${hours} hour${hours !== 1 ? "s" : ""}`;
    } else {
      return `${minutes} minute${minutes !== 1 ? "s" : ""}`;
    }
  }
  /**
   * Check if token needs refresh soon (within 24 hours)
   * @param expiryDate - Unix timestamp when token expires
   * @returns true if token expires within 24 hours
   */
  static needsRefreshSoon(expiryDate) {
    if (!expiryDate) {
      return false;
    }
    const oneDayInMs = 24 * 60 * 60 * 1e3;
    const remaining = expiryDate - Date.now();
    return remaining > 0 && remaining < oneDayInMs;
  }
  /**
   * Format expiry date to readable string
   * @param expiryDate - Unix timestamp when token expires
   * @returns Formatted date string
   */
  static formatExpiryDate(expiryDate) {
    if (!expiryDate) {
      return "Never";
    }
    const date = new Date(expiryDate);
    return date.toLocaleDateString(void 0, {
      year: "numeric",
      month: "long",
      day: "numeric",
      hour: "2-digit",
      minute: "2-digit"
    });
  }
};

// src/components/tabs/google/settings-ui.ts
var GoogleSettingsUI = class {
  /**
   * Render setup guide with step-by-step instructions
   */
  static renderSetupGuide(containerEl) {
    const setupSection = containerEl.createDiv({ cls: "pmc-setup-guide" });
    setupSection.createEl("h4", { text: "\u{1F4CB} Setup Guide" });
    const setupSteps = setupSection.createEl("ol");
    const step1 = setupSteps.createEl("li");
    step1.createEl("strong", { text: "Create a Google Cloud Project:" });
    const step1List = step1.createEl("ul");
    step1List.createEl("li").innerHTML = 'Go to <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a>';
    step1List.createEl("li", {
      text: 'Click "Select a project" \u2192 "New Project"'
    });
    step1List.createEl("li", {
      text: 'Give it a name (e.g., "Obsidian PMC Plugin") and click "Create"'
    });
    const step2 = setupSteps.createEl("li");
    step2.createEl("strong", { text: "Enable Google Calendar API:" });
    const step2List = step2.createEl("ul");
    step2List.createEl("li", {
      text: 'In the sidebar, go to "APIs & Services" \u2192 "Library"'
    });
    step2List.createEl("li", { text: 'Search for "Google Calendar API"' });
    step2List.createEl("li", { text: 'Click on it and press "Enable"' });
    const step3 = setupSteps.createEl("li");
    step3.createEl("strong", { text: "Create OAuth 2.0 Credentials:" });
    const step3List = step3.createEl("ul");
    step3List.createEl("li", {
      text: 'Go to "APIs & Services" \u2192 "Credentials"'
    });
    step3List.createEl("li", {
      text: 'Click "Create Credentials" \u2192 "OAuth client ID"'
    });
    step3List.createEl("li", {
      text: "If prompted, configure the OAuth consent screen first"
    });
    step3List.createEl("li", {
      text: 'Select "Web application" as the application type'
    });
    step3List.createEl("li", { text: "Add this Authorized redirect URI: " }).createEl("code", { text: GOOGLE_OAUTH_CALLBACK_URL });
    step3List.createEl("li", {
      text: 'Click "Create" and copy your Client ID'
    });
    const step4 = setupSteps.createEl("li");
    step4.createEl("strong", {
      text: "Paste the Client ID below and click Connect"
    });
  }
  /**
   * Render OAuth callback URL setting
   */
  static renderCallbackUrlSetting(containerEl) {
    new import_obsidian3.Setting(containerEl).setName("OAuth Callback URL").setDesc("Use this URL when configuring your Google OAuth application").addText(
      (text) => text.setValue(GOOGLE_OAUTH_CALLBACK_URL).setDisabled(true)
    ).addButton(
      (btn) => btn.setButtonText("Copy").onClick(() => {
        navigator.clipboard.writeText(GOOGLE_OAUTH_CALLBACK_URL);
        new import_obsidian3.Notice("Callback URL copied to clipboard!");
      })
    );
  }
  /**
   * Render Client ID input setting
   */
  static renderClientIdSetting(containerEl, currentClientId, onSave) {
    new import_obsidian3.Setting(containerEl).setName("Client ID").setDesc("OAuth 2.0 Client ID from Google Cloud Console").addText(
      (text) => text.setPlaceholder("123456789-abcdefg.apps.googleusercontent.com").setValue(currentClientId).onChange(async (value) => {
        await onSave(value.trim());
      })
    );
  }
  /**
   * Render token expiry dropdown setting
   */
  static renderTokenExpirySetting(containerEl, currentExpiry, onSave) {
    new import_obsidian3.Setting(containerEl).setName("Token Expiry").setDesc(
      "How long before the access token expires and requires re-authentication"
    ).addDropdown((dropdown) => {
      Object.entries(TOKEN_EXPIRY_OPTIONS).forEach(([key, label]) => {
        dropdown.addOption(key, label);
      });
      dropdown.setValue(currentExpiry).onChange(async (value) => {
        await onSave(value);
      });
    });
  }
  /**
   * Render token status information
   */
  static renderTokenStatus(containerEl, expiryDate) {
    if (!expiryDate) return;
    const timeRemaining = TokenManager.getTimeRemaining(expiryDate);
    const isExpired = TokenManager.isTokenExpired(expiryDate);
    const needsRefresh = TokenManager.needsRefreshSoon(expiryDate);
    const statusText = isExpired ? "\u26A0\uFE0F Token expired" : needsRefresh ? `\u26A0\uFE0F Token expires in ${timeRemaining}` : `Token valid for ${timeRemaining}`;
    new import_obsidian3.Setting(containerEl).setName("Token Status").setDesc(statusText);
  }
  /**
   * Render account connection setting with buttons
   */
  static renderAccountSetting(containerEl, isConnected, clientId, onConnect, onDisconnect, onSync) {
    console.log("is connected:", isConnected);
    const accountSetting = new import_obsidian3.Setting(containerEl).setName("Account").setDesc(isConnected ? "\u2705 Connected" : "\u274C Not Connected");
    if (isConnected) {
      accountSetting.addButton(
        (btn) => btn.setButtonText("Sync Calendar").onClick(async () => {
          await onSync();
        })
      );
      accountSetting.addButton(
        (btn) => btn.setWarning().setButtonText("Disconnect").onClick(async () => {
          await onDisconnect();
        })
      );
    } else {
      if (!clientId || clientId === "") {
        accountSetting.setDesc("\u26A0\uFE0F Please set Client ID first");
      } else {
        accountSetting.addButton(
          (btn) => btn.setCta().setButtonText("Connect to Google").onClick(() => {
            onConnect();
          })
        );
      }
    }
  }
};

// src/components/setting.ts
var DEFAULT_SETTINGS = {
  ...DEFAULT_GOOGLE_SETTINGS
};
var PMCPluginSetting = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h3", { text: "Google Calendar Integration" });
    GoogleSettingsUI.renderSetupGuide(containerEl);
    GoogleSettingsUI.renderCallbackUrlSetting(containerEl);
    GoogleSettingsUI.renderClientIdSetting(
      containerEl,
      this.plugin.settings.clientId,
      async (clientId) => {
        this.plugin.settings.clientId = clientId;
        await this.plugin.saveSettings();
        this.display();
      }
    );
    GoogleSettingsUI.renderTokenExpirySetting(
      containerEl,
      this.plugin.settings.tokenExpiry,
      async (expiry) => {
        this.plugin.settings.tokenExpiry = expiry;
        this.plugin.settings.tokenExpiryDate = TokenManager.calculateExpiryDate(expiry);
        await this.plugin.saveSettings();
        this.display();
      }
    );
    new import_obsidian4.Setting(containerEl).setName("Suggestion Time Range").setDesc(
      'Time duration to fetch calendar events for suggestions (e.g., "90 days"). Events from this many days in the past and future will be considered.'
    ).addText(
      (text) => text.setPlaceholder("90 days").setValue(String(this.plugin.settings.timeRange)).onChange(async (value) => {
        this.plugin.settings.timeRange = Number(value);
        await this.plugin.saveSettings();
      })
    );
    if (this.plugin.settings.accessToken && this.plugin.settings.tokenExpiryDate) {
      GoogleSettingsUI.renderTokenStatus(
        containerEl,
        this.plugin.settings.tokenExpiryDate
      );
    }
    GoogleSettingsUI.renderAccountSetting(
      containerEl,
      !!this.plugin.settings.accessToken,
      this.plugin.settings.clientId,
      () => {
        GoogleAuth.initiateOAuthFlow(this.plugin.settings.clientId);
      },
      async () => {
        this.plugin.settings.accessToken = "";
        this.plugin.settings.tokenExpiryDate = void 0;
        await this.plugin.saveSettings();
        this.display();
        GoogleAuth.disconnect();
      },
      async () => {
        await GoogleCalendarAPI.syncCalendar(this.plugin.settings.accessToken);
      }
    );
  }
};

// src/main.ts
var import_obsidian8 = require("obsidian");

// src/components/event-suggestion.ts
var import_obsidian6 = require("obsidian");

// src/components/create-event.ts
var import_obsidian5 = require("obsidian");
var CreateEventModal = class extends import_obsidian5.Modal {
  constructor(app, plugin, initialTitle, onSubmit) {
    super(app);
    this.plugin = plugin;
    this.initialTitle = initialTitle;
    this.onSubmit = onSubmit;
    this.title = initialTitle || "";
    this.isAllDay = false;
    this.description = "";
    const now = /* @__PURE__ */ new Date();
    this.date = now.toISOString().split("T")[0] || "";
    const startHour = (now.getHours() + 1) % 24;
    const endHour = (now.getHours() + 2) % 24;
    this.startTime = `${String(startHour).padStart(2, "0")}:00`;
    this.endTime = `${String(endHour).padStart(2, "0")}:00`;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Create Calendar Event" });
    new import_obsidian5.Setting(contentEl).setName("Event title").setDesc("Name of the event").addText(
      (text) => text.setPlaceholder("Team Meeting").setValue(this.title).onChange((value) => {
        this.title = value;
      })
    );
    new import_obsidian5.Setting(contentEl).setName("Date").setDesc("Event date").addText((text) => {
      text.setPlaceholder("YYYY-MM-DD").setValue(this.date).onChange((value) => {
        this.date = value;
      });
      text.inputEl.type = "date";
    });
    new import_obsidian5.Setting(contentEl).setName("All-day event").setDesc("Toggle for all-day events").addToggle(
      (toggle) => toggle.setValue(this.isAllDay).onChange((value) => {
        this.isAllDay = value;
        const timeSettings = contentEl.querySelectorAll(".time-setting");
        timeSettings.forEach((el) => {
          el.style.display = value ? "none" : "flex";
        });
      })
    );
    const startTimeSetting = new import_obsidian5.Setting(contentEl).setName("Start time").setDesc("Event start time").addText((text) => {
      text.setPlaceholder("09:00").setValue(this.startTime).onChange((value) => {
        this.startTime = value;
      });
      text.inputEl.type = "time";
    });
    startTimeSetting.settingEl.addClass("time-setting");
    const endTimeSetting = new import_obsidian5.Setting(contentEl).setName("End time").setDesc("Event end time").addText((text) => {
      text.setPlaceholder("10:00").setValue(this.endTime).onChange((value) => {
        this.endTime = value;
      });
      text.inputEl.type = "time";
    });
    endTimeSetting.settingEl.addClass("time-setting");
    new import_obsidian5.Setting(contentEl).setName("Description").setDesc("Additional details (optional)").addTextArea((text) => {
      text.setPlaceholder("Meeting agenda, notes, etc.").setValue(this.description).onChange((value) => {
        this.description = value;
      });
      text.inputEl.rows = 4;
      text.inputEl.style.width = "100%";
    });
    const buttonContainer = contentEl.createDiv({
      cls: "modal-button-container"
    });
    buttonContainer.style.cssText = "display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end;";
    const cancelBtn = buttonContainer.createEl("button", { text: "Cancel" });
    cancelBtn.addEventListener("click", () => {
      this.close();
    });
    const createBtn = buttonContainer.createEl("button", {
      text: "Create Event",
      cls: "mod-cta"
    });
    createBtn.addEventListener("click", () => {
      this.createEvent();
    });
  }
  async createEvent() {
    if (!this.title.trim()) {
      new import_obsidian5.Notice("\u274C Event title is required");
      return;
    }
    if (!this.date) {
      new import_obsidian5.Notice("\u274C Event date is required");
      return;
    }
    if (!this.isAllDay && (!this.startTime || !this.endTime)) {
      new import_obsidian5.Notice("\u274C Start and end times are required");
      return;
    }
    if (!this.plugin.settings.accessToken) {
      new import_obsidian5.Notice("\u274C Not authenticated. Please connect your Google account in settings.");
      return;
    }
    if (TokenManager.isTokenExpired(this.plugin.settings.tokenExpiryDate)) {
      new import_obsidian5.Notice("\u274C Access token has expired. Please reconnect your Google account in settings.");
      return;
    }
    try {
      const event = {
        summary: this.title.trim(),
        description: this.description.trim() || void 0
      };
      if (this.isAllDay) {
        event.start = {
          date: this.date,
          timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };
        event.end = {
          date: this.date,
          timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };
      } else {
        const startDateTime = `${this.date}T${this.startTime}:00`;
        const endDateTime = `${this.date}T${this.endTime}:00`;
        event.start = {
          dateTime: startDateTime,
          timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };
        event.end = {
          dateTime: endDateTime,
          timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };
      }
      console.log("Creating event:", event);
      const createdEvent = await GoogleCalendarAPI.createEvent(
        this.plugin.settings.accessToken,
        event,
        "primary"
      );
      console.log("Event created:", createdEvent);
      const eventLink = createdEvent.htmlLink || `https://calendar.google.com/calendar/event?eid=${encodeURIComponent(createdEvent.id)}`;
      new import_obsidian5.Notice(`\u2705 Event "${this.title}" created successfully!`);
      this.onSubmit({
        title: this.title,
        link: eventLink
      });
      this.close();
    } catch (error) {
      console.error("Error creating event:", error);
      const errorMessage = error instanceof Error ? error.message : "Unknown error";
      new import_obsidian5.Notice(`\u274C Failed to create event: ${errorMessage}`);
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/components/event-suggestion.ts
var EditorEventSuggestion = class extends import_obsidian6.EditorSuggest {
  // 5 minutes
  constructor(app, plugin) {
    super(app);
    this.cachedEvents = [];
    this.lastFetchTime = 0;
    this.CACHE_DURATION = 5 * 60 * 1e3;
    this.plugin = plugin;
  }
  onTrigger(cursor, editor, file) {
    const line = editor.getLine(cursor.line);
    const textBeforeCursor = line.substring(0, cursor.ch);
    if (textBeforeCursor.endsWith(":")) {
      return {
        start: { line: cursor.line, ch: cursor.ch - 1 },
        end: cursor,
        query: ""
      };
    }
    return null;
  }
  async fetchEventsWithCache(query) {
    const now = Date.now();
    const shouldRefetch = now - this.lastFetchTime > this.CACHE_DURATION;
    if (shouldRefetch || this.cachedEvents.length === 0) {
      try {
        const timeMin = new Date(
          Date.now() - 7 * 24 * 60 * 60 * 1e3
        ).toISOString();
        const timeMax = new Date(
          Date.now() + this.plugin.settings.timeRange * 24 * 60 * 60 * 1e3
        ).toISOString();
        this.cachedEvents = await GoogleCalendarAPI.fetchEvents(
          this.plugin.settings.accessToken,
          "primary",
          void 0,
          timeMin,
          timeMax
        );
        this.lastFetchTime = now;
      } catch (error) {
        console.error("Error fetching events:", error);
        return [];
      }
    }
    return this.cachedEvents;
  }
  filterEvents(events, query) {
    if (!query || query.trim() === "") {
      return events;
    }
    const lowerQuery = query.toLowerCase().trim();
    return events.filter((event) => {
      var _a, _b, _c, _d;
      if ((_a = event.summary) == null ? void 0 : _a.toLowerCase().includes(lowerQuery)) {
        return true;
      }
      if ((_b = event.description) == null ? void 0 : _b.toLowerCase().includes(lowerQuery)) {
        return true;
      }
      if ((_c = event.location) == null ? void 0 : _c.toLowerCase().includes(lowerQuery)) {
        return true;
      }
      if ((_d = event.attendees) == null ? void 0 : _d.some(
        (attendee) => {
          var _a2, _b2;
          return ((_a2 = attendee.email) == null ? void 0 : _a2.toLowerCase().includes(lowerQuery)) || ((_b2 = attendee.displayName) == null ? void 0 : _b2.toLowerCase().includes(lowerQuery));
        }
      )) {
        return true;
      }
      return false;
    });
  }
  // return list of suggestions
  async getSuggestions(context) {
    if (this.plugin.settings.accessToken === "") {
      console.log("connect google calendar first");
      new import_obsidian6.Notice("Please connect to Google Calendar first");
      return [];
    }
    const query = (context.query || "").trim();
    try {
      const allEvents = await this.fetchEventsWithCache();
      const filteredEvents = this.filterEvents(allEvents, query);
      console.log("filtered events", filteredEvents);
      const suggestions = [];
      suggestions.push(
        ...filteredEvents.map((event) => ({
          event,
          summary: event.summary || event.description || "Untitled Event"
        }))
      );
      return [
        {
          isCreate: true,
          summary: `+ Create new event`
        },
        ...suggestions
      ];
    } catch (error) {
      console.error("Error getting suggestions:", error);
      return [];
    }
  }
  // render each suggestion
  renderSuggestion(item, el) {
    el.empty();
    const container = el.createDiv({ cls: "gcal-suggestion-container" });
    container.style.cssText = "display: flex; justify-content: space-between; align-items: center; padding: 4px 0;";
    if (item.isCreate) {
      container.style.cssText += "color: var(--interactive-accent); font-weight: 600;";
      container.createEl("span", { text: item.summary });
    } else if (item.event) {
      const event = item.event;
      const leftDiv = container.createDiv();
      leftDiv.style.cssText = "flex: 1; min-width: 0;";
      const titleEl = leftDiv.createEl("div", {
        text: event.summary || "Untitled Event",
        cls: "gcal-event-title"
      });
      titleEl.style.cssText = "font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;";
      if (event.location) {
        const locationEl = leftDiv.createEl("div", {
          text: event.location,
          cls: "gcal-event-location"
        });
        locationEl.style.cssText = "font-size: 0.8em; color: var(--text-muted); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; margin-top: 2px;";
      }
      const rightDiv = container.createDiv();
      rightDiv.style.cssText = "flex-shrink: 0; margin-left: 12px; text-align: right;";
      try {
        const startDate = new Date(
          event.start.dateTime || event.start.date || ""
        );
        const now = /* @__PURE__ */ new Date();
        const isToday = startDate.toDateString() === now.toDateString();
        const isTomorrow = startDate.toDateString() === new Date(now.getTime() + 864e5).toDateString();
        let dateStr = "";
        if (isToday) {
          dateStr = "Today";
        } else if (isTomorrow) {
          dateStr = "Tomorrow";
        } else {
          dateStr = startDate.toLocaleDateString([], {
            month: "short",
            day: "numeric",
            year: startDate.getFullYear() !== now.getFullYear() ? "numeric" : void 0
          });
        }
        let timeStr = "";
        if (event.start.dateTime) {
          timeStr = startDate.toLocaleTimeString([], {
            hour: "numeric",
            minute: "2-digit",
            hour12: true
          });
        } else {
          timeStr = "All day";
        }
        const dateEl = rightDiv.createEl("div", {
          text: dateStr,
          cls: "gcal-event-date"
        });
        dateEl.style.cssText = "font-size: 0.85em; color: var(--text-muted);";
        const timeEl = rightDiv.createEl("div", {
          text: timeStr,
          cls: "gcal-event-time"
        });
        timeEl.style.cssText = "font-size: 0.9em; font-weight: 500;";
        if (event.hangoutLink || event.conferenceData) {
          const conferenceEl = rightDiv.createEl("div", {
            text: "\u{1F3A5} Video",
            cls: "gcal-event-conference"
          });
          conferenceEl.style.cssText = "font-size: 0.75em; color: var(--interactive-accent); margin-top: 2px;";
        }
      } catch (e) {
        console.error("Error formatting date:", e);
        rightDiv.createEl("small", {
          text: "Invalid date",
          attr: { style: "color: var(--text-error);" }
        });
      }
    }
  }
  // user selects a suggestion
  selectSuggestion(item, evt) {
    if (!this.context) {
      console.error("No context available");
      return;
    }
    if (item.isCreate) {
      new CreateEventModal(
        this.app,
        this.plugin,
        this.context.query,
        (eventData) => {
          if (this.context) {
            const formattedText = `[${eventData.title}](${eventData.link})`;
            this.context.editor.replaceRange(
              formattedText,
              this.context.start,
              this.context.end
            );
          }
        }
      ).open();
    } else if (item.event) {
      const event = item.event;
      const eventLink = event.htmlLink || `https://calendar.google.com/calendar/event?eid=${encodeURIComponent(event.id)}`;
      const eventTitle = event.summary || "Untitled Event";
      const formattedText = `[${eventTitle}](${eventLink})`;
      this.context.editor.replaceRange(
        formattedText,
        this.context.start,
        this.context.end
      );
    }
  }
  // Clear cache when needed (can be called from plugin)
  clearCache() {
    this.cachedEvents = [];
    this.lastFetchTime = 0;
  }
};

// src/components/donate-modal.ts
var import_obsidian7 = require("obsidian");
var DonationModal = class extends import_obsidian7.Modal {
  constructor(app) {
    super(app);
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("donation-modal");
    contentEl.createEl("h2", {
      text: "\u2764\uFE0F Support Development",
      cls: "donation-header"
    });
    contentEl.createEl("p", {
      text: "If you enjoy using this plugin, consider supporting its development! Your support helps keep this project alive and enables new features.",
      cls: "donation-description"
    });
    new import_obsidian7.Setting(contentEl).setName("\u2615 Buy Me a Coffee").setDesc("Support with a one-time donation").addButton(
      (btn) => btn.setButtonText("Donate").setCta().onClick(() => {
        window.open("https://www.buymeacoffee.com/yourusername", "_blank");
      })
    );
    new import_obsidian7.Setting(contentEl).setName("\u2B50 GitHub Sponsors").setDesc("Sponsor on GitHub for recurring support").addButton(
      (btn) => btn.setButtonText("Become a Sponsor").onClick(() => {
        window.open("https://github.com/sponsors/yourusername", "_blank");
      })
    );
    contentEl.createEl("p", {
      text: "Thank you for your support! Every contribution helps improve this plugin. \u{1F64F}",
      cls: "donation-thanks"
    });
    new import_obsidian7.Setting(contentEl).addButton(
      (btn) => btn.setButtonText("Close").onClick(() => {
        this.close();
      })
    );
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/main.ts
var PMCPlugin = class extends import_obsidian8.Plugin {
  constructor() {
    super(...arguments);
    this.settingTab = null;
    this.editorSuggestion = null;
  }
  async onload() {
    await this.loadSettings();
    this.settingTab = new PMCPluginSetting(this.app, this);
    this.addSettingTab(this.settingTab);
    this.addRibbonIcon(
      "heart",
      "Support Plugin Development",
      (evt) => {
        new DonationModal(this.app).open();
      }
    );
    this.registerObsidianProtocolHandler("pick-meeting-token", async (data) => {
      var _a;
      const token = data.access_token;
      if (token) {
        this.settings.accessToken = token;
        await this.saveSettings();
        (_a = this.settingTab) == null ? void 0 : _a.display();
        new import_obsidian8.Notice("\u2705 Google Calendar Connected!");
      } else {
        new import_obsidian8.Notice(
          `\u274C Connection failed: ${data.error || "No token found in response"}`
        );
      }
    });
    this.editorSuggestion = new EditorEventSuggestion(this.app, this);
    this.registerEditorSuggest(this.editorSuggestion);
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2NvbXBvbmVudHMvc2V0dGluZy50cyIsICJzcmMvY29tcG9uZW50cy90YWJzL2dvb2dsZS90eXBlcy50cyIsICJzcmMvY29tcG9uZW50cy90YWJzL2dvb2dsZS9hdXRoLnRzIiwgInNyYy9jb21wb25lbnRzL3RhYnMvZ29vZ2xlL2NhbGVuZGFyLWFwaS50cyIsICJzcmMvY29tcG9uZW50cy90YWJzL2dvb2dsZS9zZXR0aW5ncy11aS50cyIsICJzcmMvY29tcG9uZW50cy90YWJzL2dvb2dsZS90b2tlbi1tYW5hZ2VyLnRzIiwgInNyYy9jb21wb25lbnRzL2V2ZW50LXN1Z2dlc3Rpb24udHMiLCAic3JjL2NvbXBvbmVudHMvY3JlYXRlLWV2ZW50LnRzIiwgInNyYy9jb21wb25lbnRzL2RvbmF0ZS1tb2RhbC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcbiAgREVGQVVMVF9TRVRUSU5HUyxcbiAgUE1DUGx1Z2luU2V0dGluZyxcbiAgUE1DUGx1Z2luU2V0dGluZ1R5cGUsXG59IGZyb20gXCJjb21wb25lbnRzL3NldHRpbmdcIjtcbmltcG9ydCB7IE5vdGljZSwgUGx1Z2luIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgXCIuL3N0eWxlLmNzc1wiO1xuaW1wb3J0IHsgRWRpdG9yRXZlbnRTdWdnZXN0aW9uIH0gZnJvbSBcImNvbXBvbmVudHMvZXZlbnQtc3VnZ2VzdGlvblwiO1xuaW1wb3J0IHsgRG9uYXRpb25Nb2RhbCB9IGZyb20gXCJjb21wb25lbnRzL2RvbmF0ZS1tb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQTUNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICBzZXR0aW5nczogUE1DUGx1Z2luU2V0dGluZ1R5cGU7XG4gIHNldHRpbmdUYWI6IFBNQ1BsdWdpblNldHRpbmcgfCBudWxsID0gbnVsbDtcbiAgZWRpdG9yU3VnZ2VzdGlvbjogRWRpdG9yRXZlbnRTdWdnZXN0aW9uIHwgbnVsbCA9IG51bGw7XG5cbiAgYXN5bmMgb25sb2FkKCkge1xuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAvL3JlZ2lzdGVyIHNldHRpbmdzIHRhYlxuICAgIHRoaXMuc2V0dGluZ1RhYiA9IG5ldyBQTUNQbHVnaW5TZXR0aW5nKHRoaXMuYXBwLCB0aGlzKTtcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nVGFiKTtcblxuICAgIC8vIEFkZCBkb25hdGUgdGFiIFx1Mjc2NFx1RkUwRlxuICAgIHRoaXMuYWRkUmliYm9uSWNvbihcbiAgICAgIFwiaGVhcnRcIixcbiAgICAgIFwiU3VwcG9ydCBQbHVnaW4gRGV2ZWxvcG1lbnRcIixcbiAgICAgIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgbmV3IERvbmF0aW9uTW9kYWwodGhpcy5hcHApLm9wZW4oKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vZ29vZ2xlIG9hdXRoIGNhbGxiYWNrIGhhbmRsZXJcbiAgICB0aGlzLnJlZ2lzdGVyT2JzaWRpYW5Qcm90b2NvbEhhbmRsZXIoXCJwaWNrLW1lZXRpbmctdG9rZW5cIiwgYXN5bmMgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gZGF0YS5hY2Nlc3NfdG9rZW47XG5cbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICB0aGlzLnNldHRpbmdzLmFjY2Vzc1Rva2VuID0gdG9rZW47XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ1RhYj8uZGlzcGxheSgpO1xuICAgICAgICBuZXcgTm90aWNlKFwiXHUyNzA1IEdvb2dsZSBDYWxlbmRhciBDb25uZWN0ZWQhXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3IE5vdGljZShcbiAgICAgICAgICBgXHUyNzRDIENvbm5lY3Rpb24gZmFpbGVkOiAke2RhdGEuZXJyb3IgfHwgXCJObyB0b2tlbiBmb3VuZCBpbiByZXNwb25zZVwifWAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvL3JlZ2lzdGVyIGVkaXRvciBzdWdnZXN0aW9uXG4gICAgdGhpcy5lZGl0b3JTdWdnZXN0aW9uID0gbmV3IEVkaXRvckV2ZW50U3VnZ2VzdGlvbih0aGlzLmFwcCwgdGhpcyk7XG4gICAgdGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QodGhpcy5lZGl0b3JTdWdnZXN0aW9uKTtcbiAgfVxuXG4gIG9udW5sb2FkKCkge31cblxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oXG4gICAgICB7fSxcbiAgICAgIERFRkFVTFRfU0VUVElOR1MsXG4gICAgICAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSBhcyBQYXJ0aWFsPFBNQ1BsdWdpblNldHRpbmdUeXBlPixcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gIH1cbn1cbiIsICJpbXBvcnQgUE1DUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7XG4gIEdvb2dsZUNhbGVuZGFyU2V0dGluZ3MsXG4gIERFRkFVTFRfR09PR0xFX1NFVFRJTkdTLFxuICBUb2tlbkV4cGlyeU9wdGlvbixcbn0gZnJvbSBcIi4vdGFicy9nb29nbGUvdHlwZXNcIjtcbmltcG9ydCB7IEdvb2dsZUF1dGggfSBmcm9tIFwiLi90YWJzL2dvb2dsZS9hdXRoXCI7XG5pbXBvcnQgeyBHb29nbGVDYWxlbmRhckFQSSB9IGZyb20gXCIuL3RhYnMvZ29vZ2xlL2NhbGVuZGFyLWFwaVwiO1xuaW1wb3J0IHsgR29vZ2xlU2V0dGluZ3NVSSB9IGZyb20gXCIuL3RhYnMvZ29vZ2xlL3NldHRpbmdzLXVpXCI7XG5pbXBvcnQgeyBUb2tlbk1hbmFnZXIgfSBmcm9tIFwiLi90YWJzL2dvb2dsZS90b2tlbi1tYW5hZ2VyXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUE1DUGx1Z2luU2V0dGluZ1R5cGUgZXh0ZW5kcyBHb29nbGVDYWxlbmRhclNldHRpbmdzIHt9XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQTUNQbHVnaW5TZXR0aW5nVHlwZSA9IHtcbiAgLi4uREVGQVVMVF9HT09HTEVfU0VUVElOR1MsXG59O1xuXG5leHBvcnQgY2xhc3MgUE1DUGx1Z2luU2V0dGluZyBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IFBNQ1BsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQTUNQbHVnaW4pIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIC8vIFRpdGxlXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiR29vZ2xlIENhbGVuZGFyIEludGVncmF0aW9uXCIgfSk7XG5cbiAgICAvLyBSZW5kZXIgc2V0dXAgZ3VpZGVcbiAgICBHb29nbGVTZXR0aW5nc1VJLnJlbmRlclNldHVwR3VpZGUoY29udGFpbmVyRWwpO1xuICAgIC8vIFJlbmRlciBPQXV0aCBjYWxsYmFjayBVUkxcbiAgICBHb29nbGVTZXR0aW5nc1VJLnJlbmRlckNhbGxiYWNrVXJsU2V0dGluZyhjb250YWluZXJFbCk7XG4gICAgLy8gUmVuZGVyIENsaWVudCBJRCBpbnB1dFxuICAgIEdvb2dsZVNldHRpbmdzVUkucmVuZGVyQ2xpZW50SWRTZXR0aW5nKFxuICAgICAgY29udGFpbmVyRWwsXG4gICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGllbnRJZCxcbiAgICAgIGFzeW5jIChjbGllbnRJZDogc3RyaW5nKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vIFJlbmRlciBUb2tlbiBFeHBpcnkgc2V0dGluZ1xuICAgIEdvb2dsZVNldHRpbmdzVUkucmVuZGVyVG9rZW5FeHBpcnlTZXR0aW5nKFxuICAgICAgY29udGFpbmVyRWwsXG4gICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2tlbkV4cGlyeSBhcyBUb2tlbkV4cGlyeU9wdGlvbixcbiAgICAgIGFzeW5jIChleHBpcnk6IFRva2VuRXhwaXJ5T3B0aW9uKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRva2VuRXhwaXJ5ID0gZXhwaXJ5O1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2tlbkV4cGlyeURhdGUgPVxuICAgICAgICAgIFRva2VuTWFuYWdlci5jYWxjdWxhdGVFeHBpcnlEYXRlKGV4cGlyeSk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vc3VnZ2VzdGlvbiB0aW1lIHJhbmdlIHNldHRpbmdcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiU3VnZ2VzdGlvbiBUaW1lIFJhbmdlXCIpXG4gICAgICAuc2V0RGVzYyhcbiAgICAgICAgJ1RpbWUgZHVyYXRpb24gdG8gZmV0Y2ggY2FsZW5kYXIgZXZlbnRzIGZvciBzdWdnZXN0aW9ucyAoZS5nLiwgXCI5MCBkYXlzXCIpLiBFdmVudHMgZnJvbSB0aGlzIG1hbnkgZGF5cyBpbiB0aGUgcGFzdCBhbmQgZnV0dXJlIHdpbGwgYmUgY29uc2lkZXJlZC4nLFxuICAgICAgKVxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIHRleHRcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCI5MCBkYXlzXCIpXG4gICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy50aW1lUmFuZ2UpKSAvLyBFbnN1cmUgeW91ciBzZXR0aW5ncyBvYmplY3QgaGFzIHRoaXMga2V5XG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGltZVJhbmdlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgIC8vIFJlbmRlciB0b2tlbiBzdGF0dXMgaWYgY29ubmVjdGVkXG4gICAgaWYgKFxuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWNjZXNzVG9rZW4gJiZcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRva2VuRXhwaXJ5RGF0ZVxuICAgICkge1xuICAgICAgR29vZ2xlU2V0dGluZ3NVSS5yZW5kZXJUb2tlblN0YXR1cyhcbiAgICAgICAgY29udGFpbmVyRWwsXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRva2VuRXhwaXJ5RGF0ZSxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gUmVuZGVyIGFjY291bnQgY29ubmVjdGlvbiBzZWN0aW9uXG4gICAgR29vZ2xlU2V0dGluZ3NVSS5yZW5kZXJBY2NvdW50U2V0dGluZyhcbiAgICAgIGNvbnRhaW5lckVsLFxuICAgICAgISF0aGlzLnBsdWdpbi5zZXR0aW5ncy5hY2Nlc3NUb2tlbixcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsaWVudElkLFxuICAgICAgKCkgPT4ge1xuICAgICAgICAvLyBPbiBDb25uZWN0XG4gICAgICAgIEdvb2dsZUF1dGguaW5pdGlhdGVPQXV0aEZsb3codGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xpZW50SWQpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWNjZXNzVG9rZW4gPSBcIlwiO1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50b2tlbkV4cGlyeURhdGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgR29vZ2xlQXV0aC5kaXNjb25uZWN0KCk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCBHb29nbGVDYWxlbmRhckFQSS5zeW5jQ2FsZW5kYXIodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWNjZXNzVG9rZW4pO1xuICAgICAgfSxcbiAgICApO1xuICB9XG59XG4iLCAiZXhwb3J0IGludGVyZmFjZSBHb29nbGVDYWxlbmRhclNldHRpbmdzIHtcbiAgY2xpZW50SWQ6IHN0cmluZztcbiAgYWNjZXNzVG9rZW46IHN0cmluZztcbiAgdG9rZW5FeHBpcnk6IHN0cmluZztcbiAgdG9rZW5FeHBpcnlEYXRlPzogbnVtYmVyO1xuICB0aW1lUmFuZ2U6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfR09PR0xFX1NFVFRJTkdTOiBHb29nbGVDYWxlbmRhclNldHRpbmdzID0ge1xuICBjbGllbnRJZDogXCJcIixcbiAgYWNjZXNzVG9rZW46IFwiXCIsXG4gIHRva2VuRXhwaXJ5OiBcInVubGltaXRlZFwiLFxuICB0b2tlbkV4cGlyeURhdGU6IHVuZGVmaW5lZCxcbiAgdGltZVJhbmdlOiA5MCxcbn07XG5cbmV4cG9ydCB0eXBlIFRva2VuRXhwaXJ5T3B0aW9uID1cbiAgfCBcIjF3ZWVrXCJcbiAgfCBcIjFtb250aFwiXG4gIHwgXCIzbW9udGhzXCJcbiAgfCBcIjZtb250aHNcIlxuICB8IFwidW5saW1pdGVkXCI7XG5cbmV4cG9ydCBjb25zdCBUT0tFTl9FWFBJUllfT1BUSU9OUzogUmVjb3JkPFRva2VuRXhwaXJ5T3B0aW9uLCBzdHJpbmc+ID0ge1xuICBcIjF3ZWVrXCI6IFwiMSBXZWVrXCIsXG4gIFwiMW1vbnRoXCI6IFwiMSBNb250aFwiLFxuICBcIjNtb250aHNcIjogXCIzIE1vbnRoc1wiLFxuICBcIjZtb250aHNcIjogXCI2IE1vbnRoc1wiLFxuICB1bmxpbWl0ZWQ6IFwiVW5saW1pdGVkIChVbnRpbCBtYW51YWxseSBkaXNjb25uZWN0ZWQpXCIsXG59O1xuXG5leHBvcnQgY29uc3QgR09PR0xFX09BVVRIX0NBTExCQUNLX1VSTCA9XG4gIFwiaHR0cHM6Ly9yYWplZXZyYWpjaGFsLmdpdGh1Yi5pby9wbWMvb2F1dGgtY2FsbGJhY2tcIjtcblxuZXhwb3J0IGludGVyZmFjZSBPQXV0aFRva2VuUmVzcG9uc2Uge1xuICBhY2Nlc3NfdG9rZW46IHN0cmluZztcbiAgZXhwaXJlc19pbjogbnVtYmVyO1xuICBzY29wZTogc3RyaW5nO1xuICB0b2tlbl90eXBlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FsZW5kYXJFdmVudCB7XG4gIGtpbmQ6IHN0cmluZztcbiAgZXRhZzogc3RyaW5nO1xuICBpZDogc3RyaW5nO1xuICBzdGF0dXM6IHN0cmluZztcbiAgaHRtbExpbms6IHN0cmluZztcbiAgY3JlYXRlZDogc3RyaW5nO1xuICB1cGRhdGVkOiBzdHJpbmc7XG4gIHN1bW1hcnk6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIGxvY2F0aW9uPzogc3RyaW5nO1xuICBjcmVhdG9yPzoge1xuICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgZGlzcGxheU5hbWU/OiBzdHJpbmc7XG4gICAgc2VsZj86IGJvb2xlYW47XG4gIH07XG4gIG9yZ2FuaXplcj86IHtcbiAgICBlbWFpbDogc3RyaW5nO1xuICAgIGRpc3BsYXlOYW1lPzogc3RyaW5nO1xuICAgIHNlbGY/OiBib29sZWFuO1xuICB9O1xuICBzdGFydDoge1xuICAgIGRhdGVUaW1lPzogc3RyaW5nO1xuICAgIGRhdGU/OiBzdHJpbmc7XG4gICAgdGltZVpvbmU/OiBzdHJpbmc7XG4gIH07XG4gIGVuZDoge1xuICAgIGRhdGVUaW1lPzogc3RyaW5nO1xuICAgIGRhdGU/OiBzdHJpbmc7XG4gICAgdGltZVpvbmU/OiBzdHJpbmc7XG4gIH07XG4gIGlDYWxVSUQ/OiBzdHJpbmc7XG4gIHNlcXVlbmNlPzogbnVtYmVyO1xuICBhdHRlbmRlZXM/OiBBcnJheTx7XG4gICAgZW1haWw6IHN0cmluZztcbiAgICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgICByZXNwb25zZVN0YXR1cz86IHN0cmluZztcbiAgICBzZWxmPzogYm9vbGVhbjtcbiAgICBvcmdhbml6ZXI/OiBib29sZWFuO1xuICB9PjtcbiAgaGFuZ291dExpbms/OiBzdHJpbmc7XG4gIGNvbmZlcmVuY2VEYXRhPzoge1xuICAgIGNyZWF0ZVJlcXVlc3Q/OiB7XG4gICAgICByZXF1ZXN0SWQ6IHN0cmluZztcbiAgICAgIGNvbmZlcmVuY2VTb2x1dGlvbktleToge1xuICAgICAgICB0eXBlOiBzdHJpbmc7XG4gICAgICB9O1xuICAgICAgc3RhdHVzOiB7XG4gICAgICAgIHN0YXR1c0NvZGU6IHN0cmluZztcbiAgICAgIH07XG4gICAgfTtcbiAgICBlbnRyeVBvaW50cz86IEFycmF5PHtcbiAgICAgIGVudHJ5UG9pbnRUeXBlOiBzdHJpbmc7XG4gICAgICB1cmk6IHN0cmluZztcbiAgICAgIGxhYmVsPzogc3RyaW5nO1xuICAgIH0+O1xuICAgIGNvbmZlcmVuY2VTb2x1dGlvbj86IHtcbiAgICAgIGtleToge1xuICAgICAgICB0eXBlOiBzdHJpbmc7XG4gICAgICB9O1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgaWNvblVyaT86IHN0cmluZztcbiAgICB9O1xuICAgIGNvbmZlcmVuY2VJZD86IHN0cmluZztcbiAgfTtcbiAgcmVtaW5kZXJzPzoge1xuICAgIHVzZURlZmF1bHQ6IGJvb2xlYW47XG4gICAgb3ZlcnJpZGVzPzogQXJyYXk8e1xuICAgICAgbWV0aG9kOiBzdHJpbmc7XG4gICAgICBtaW51dGVzOiBudW1iZXI7XG4gICAgfT47XG4gIH07XG4gIGV2ZW50VHlwZTogc3RyaW5nO1xufVxuIiwgIi8qKlxuICogR29vZ2xlIE9BdXRoIGF1dGhlbnRpY2F0aW9uIGFuZCBjb25uZWN0aW9uIG1hbmFnZW1lbnRcbiAqL1xuXG5pbXBvcnQgeyBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEdPT0dMRV9PQVVUSF9DQUxMQkFDS19VUkwgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5leHBvcnQgY2xhc3MgR29vZ2xlQXV0aCB7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE9BVVRIX1VSTCA9XG4gICAgXCJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvdjIvYXV0aFwiO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBTQ09QRVMgPSBbXG4gICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLnJlYWRvbmx5XCIsXG4gICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLmV2ZW50c1wiLFxuICBdO1xuXG4gIC8qKlxuICAgKiBJbml0aWF0ZSBPQXV0aCBmbG93IHRvIGNvbm5lY3QgdG8gR29vZ2xlIENhbGVuZGFyXG4gICAqIEBwYXJhbSBjbGllbnRJZCAtIE9BdXRoIDIuMCBDbGllbnQgSUQgZnJvbSBHb29nbGUgQ2xvdWQgQ29uc29sZVxuICAgKi9cbiAgc3RhdGljIGluaXRpYXRlT0F1dGhGbG93KGNsaWVudElkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAoIWNsaWVudElkIHx8IGNsaWVudElkLnRyaW0oKSA9PT0gXCJcIikge1xuICAgICAgbmV3IE5vdGljZShcIlBsZWFzZSBjb25maWd1cmUgQ2xpZW50IElEIGZpcnN0XCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGF1dGhVcmwgPSB0aGlzLmJ1aWxkQXV0aFVybChjbGllbnRJZCk7XG5cbiAgICBuZXcgTm90aWNlKFwiT3BlbmluZyBHb29nbGUgYXV0aGVudGljYXRpb24uLi5cIik7XG5cbiAgICAvLyBPcGVuIE9BdXRoIFVSTCBpbiBicm93c2VyXG4gICAgd2luZG93Lm9wZW4oYXV0aFVybCwgXCJfYmxhbmtcIik7XG4gIH1cblxuICAvKipcbiAgICogQnVpbGQgdGhlIE9BdXRoIGF1dGhvcml6YXRpb24gVVJMXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBidWlsZEF1dGhVcmwoY2xpZW50SWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICBjbGllbnRfaWQ6IGNsaWVudElkLFxuICAgICAgcmVkaXJlY3RfdXJpOiBHT09HTEVfT0FVVEhfQ0FMTEJBQ0tfVVJMLFxuICAgICAgcmVzcG9uc2VfdHlwZTogXCJ0b2tlblwiLFxuICAgICAgc2NvcGU6IHRoaXMuU0NPUEVTLmpvaW4oXCIgXCIpLFxuICAgICAgYWNjZXNzX3R5cGU6IFwib25saW5lXCIsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gYCR7dGhpcy5PQVVUSF9VUkx9PyR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEaXNjb25uZWN0IGZyb20gR29vZ2xlIENhbGVuZGFyXG4gICAqIENsZWFycyB0aGUgc3RvcmVkIGFjY2VzcyB0b2tlblxuICAgKi9cbiAgc3RhdGljIGRpc2Nvbm5lY3QoKTogdm9pZCB7XG4gICAgbmV3IE5vdGljZShcIkRpc2Nvbm5lY3RlZCBmcm9tIEdvb2dsZSBDYWxlbmRhclwiKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQ2FsZW5kYXJFdmVudCB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBHb29nbGVDYWxlbmRhckFQSSB7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEJBU0VfVVJMID0gXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9jYWxlbmRhci92M1wiO1xuXG4gIC8qKlxuICAgKiBGZXRjaCBjYWxlbmRhciBldmVudHMgZnJvbSBHb29nbGUgQ2FsZW5kYXJcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gT0F1dGggYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSBjYWxlbmRhcklkIC0gQ2FsZW5kYXIgSUQgKGRlZmF1bHRzIHRvICdwcmltYXJ5JylcbiAgICogQHBhcmFtIHF1ZXJ5IC0gU2VhcmNoIHF1ZXJ5IGZvciBldmVudHNcbiAgICogQHBhcmFtIHRpbWVNaW4gLSBTdGFydCB0aW1lIGZvciBldmVudHMgKElTTyA4NjAxKVxuICAgKiBAcGFyYW0gdGltZU1heCAtIEVuZCB0aW1lIGZvciBldmVudHMgKElTTyA4NjAxKVxuICAgKiBAcGFyYW0gbWF4UmVzdWx0cyAtIE1heGltdW0gbnVtYmVyIG9mIGV2ZW50cyB0byByZXR1cm5cbiAgICogQHJldHVybnMgQXJyYXkgb2YgY2FsZW5kYXIgZXZlbnRzXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZmV0Y2hFdmVudHMoXG4gICAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgICBjYWxlbmRhcklkOiBzdHJpbmcgPSBcInByaW1hcnlcIixcbiAgICBxdWVyeT86IHN0cmluZyxcbiAgICB0aW1lTWluPzogc3RyaW5nLFxuICAgIHRpbWVNYXg/OiBzdHJpbmcsXG4gICAgbWF4UmVzdWx0czogbnVtYmVyID0gMjUwLFxuICApOiBQcm9taXNlPENhbGVuZGFyRXZlbnRbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAgIHNpbmdsZUV2ZW50czogXCJ0cnVlXCIsXG4gICAgICAgIG9yZGVyQnk6IFwic3RhcnRUaW1lXCIsXG4gICAgICAgIG1heFJlc3VsdHM6IG1heFJlc3VsdHMudG9TdHJpbmcoKSxcbiAgICAgIH07XG5cbiAgICAgIGlmICh0aW1lTWluKSB7XG4gICAgICAgIHBhcmFtcy50aW1lTWluID0gdGltZU1pbjtcbiAgICAgIH1cbiAgICAgIGlmICh0aW1lTWF4KSB7XG4gICAgICAgIHBhcmFtcy50aW1lTWF4ID0gdGltZU1heDtcbiAgICAgIH1cbiAgICAgIGlmIChxdWVyeSAmJiBxdWVyeS50cmltKCkgIT09IFwiXCIpIHtcbiAgICAgICAgcGFyYW1zLnEgPSBxdWVyeTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcXVlcnlTdHJpbmcgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHBhcmFtcykudG9TdHJpbmcoKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5CQVNFX1VSTH0vY2FsZW5kYXJzLyR7Y2FsZW5kYXJJZH0vZXZlbnRzPyR7cXVlcnlTdHJpbmd9YCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQVBJIEVycm9yIFJlc3BvbnNlOlwiLCBlcnJvclRleHQpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBldmVudHM6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIHJldHVybiBkYXRhLml0ZW1zIHx8IFtdO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgY2FsZW5kYXIgZXZlbnRzOlwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGZldGNoIGNhbGVuZGFyIGV2ZW50c1wiKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgY2FsZW5kYXIgZXZlbnRcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gT0F1dGggYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSBldmVudCAtIEV2ZW50IGRldGFpbHMgdG8gY3JlYXRlXG4gICAqIEBwYXJhbSBjYWxlbmRhcklkIC0gQ2FsZW5kYXIgSUQgKGRlZmF1bHRzIHRvICdwcmltYXJ5JylcbiAgICogQHJldHVybnMgQ3JlYXRlZCBldmVudFxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGNyZWF0ZUV2ZW50KFxuICAgIGFjY2Vzc1Rva2VuOiBzdHJpbmcsXG4gICAgZXZlbnQ6IFBhcnRpYWw8Q2FsZW5kYXJFdmVudD4sXG4gICAgY2FsZW5kYXJJZDogc3RyaW5nID0gXCJwcmltYXJ5XCIsXG4gICk6IFByb21pc2U8Q2FsZW5kYXJFdmVudD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLkJBU0VfVVJMfS9jYWxlbmRhcnMvJHtjYWxlbmRhcklkfS9ldmVudHNgLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7YWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZXZlbnQpLFxuICAgICAgICB9LFxuICAgICAgKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgZXZlbnQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY3JlYXRlZEV2ZW50ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgbmV3IE5vdGljZShcIkV2ZW50IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgcmV0dXJuIGNyZWF0ZWRFdmVudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIGNhbGVuZGFyIGV2ZW50OlwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGNyZWF0ZSBjYWxlbmRhciBldmVudFwiKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYW4gZXhpc3RpbmcgY2FsZW5kYXIgZXZlbnRcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gT0F1dGggYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSBldmVudElkIC0gSUQgb2YgdGhlIGV2ZW50IHRvIHVwZGF0ZVxuICAgKiBAcGFyYW0gZXZlbnQgLSBVcGRhdGVkIGV2ZW50IGRldGFpbHNcbiAgICogQHBhcmFtIGNhbGVuZGFySWQgLSBDYWxlbmRhciBJRCAoZGVmYXVsdHMgdG8gJ3ByaW1hcnknKVxuICAgKiBAcmV0dXJucyBVcGRhdGVkIGV2ZW50XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgdXBkYXRlRXZlbnQoXG4gICAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgICBldmVudElkOiBzdHJpbmcsXG4gICAgZXZlbnQ6IFBhcnRpYWw8Q2FsZW5kYXJFdmVudD4sXG4gICAgY2FsZW5kYXJJZDogc3RyaW5nID0gXCJwcmltYXJ5XCIsXG4gICk6IFByb21pc2U8Q2FsZW5kYXJFdmVudD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLkJBU0VfVVJMfS9jYWxlbmRhcnMvJHtjYWxlbmRhcklkfS9ldmVudHMvJHtldmVudElkfWAsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2FjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGV2ZW50KSxcbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gdXBkYXRlIGV2ZW50OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWRFdmVudCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIG5ldyBOb3RpY2UoXCJFdmVudCB1cGRhdGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgIHJldHVybiB1cGRhdGVkRXZlbnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBjYWxlbmRhciBldmVudDpcIiwgZXJyb3IpO1xuICAgICAgbmV3IE5vdGljZShcIkZhaWxlZCB0byB1cGRhdGUgY2FsZW5kYXIgZXZlbnRcIik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVsZXRlIGEgY2FsZW5kYXIgZXZlbnRcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gT0F1dGggYWNjZXNzIHRva2VuXG4gICAqIEBwYXJhbSBldmVudElkIC0gSUQgb2YgdGhlIGV2ZW50IHRvIGRlbGV0ZVxuICAgKiBAcGFyYW0gY2FsZW5kYXJJZCAtIENhbGVuZGFyIElEIChkZWZhdWx0cyB0byAncHJpbWFyeScpXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZGVsZXRlRXZlbnQoXG4gICAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgICBldmVudElkOiBzdHJpbmcsXG4gICAgY2FsZW5kYXJJZDogc3RyaW5nID0gXCJwcmltYXJ5XCIsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLkJBU0VfVVJMfS9jYWxlbmRhcnMvJHtjYWxlbmRhcklkfS9ldmVudHMvJHtldmVudElkfWAsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2FjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZGVsZXRlIGV2ZW50OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICB9XG5cbiAgICAgIG5ldyBOb3RpY2UoXCJFdmVudCBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhbGVuZGFyIGV2ZW50OlwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGRlbGV0ZSBjYWxlbmRhciBldmVudFwiKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgbGlzdCBvZiBhdmFpbGFibGUgY2FsZW5kYXJzXG4gICAqIEBwYXJhbSBhY2Nlc3NUb2tlbiAtIE9BdXRoIGFjY2VzcyB0b2tlblxuICAgKiBAcmV0dXJucyBBcnJheSBvZiBjYWxlbmRhciBvYmplY3RzXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgbGlzdENhbGVuZGFycyhhY2Nlc3NUb2tlbjogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuQkFTRV9VUkx9L3VzZXJzL21lL2NhbGVuZGFyTGlzdGAsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggY2FsZW5kYXJzOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICByZXR1cm4gZGF0YS5pdGVtcyB8fCBbXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGNhbGVuZGFyczpcIiwgZXJyb3IpO1xuICAgICAgbmV3IE5vdGljZShcIkZhaWxlZCB0byBmZXRjaCBjYWxlbmRhcnNcIik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3luYyBjYWxlbmRhciBldmVudHMgKGZldGNoIGFuZCBjYWNoZSlcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gT0F1dGggYWNjZXNzIHRva2VuXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgc3luY0NhbGVuZGFyKGFjY2Vzc1Rva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgbmV3IE5vdGljZShcIlN5bmNpbmcgY2FsZW5kYXIuLi5cIik7XG5cbiAgICAgIC8vIEZldGNoIGV2ZW50cyBmb3IgdGhlIG5leHQgMzAgZGF5c1xuICAgICAgY29uc3QgdGltZU1pbiA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgIGNvbnN0IHRpbWVNYXggPSBuZXcgRGF0ZShcbiAgICAgICAgRGF0ZS5ub3coKSArIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgICkudG9JU09TdHJpbmcoKTtcblxuICAgICAgY29uc3QgZXZlbnRzID0gYXdhaXQgdGhpcy5mZXRjaEV2ZW50cyhcbiAgICAgICAgYWNjZXNzVG9rZW4sXG4gICAgICAgIFwicHJpbWFyeVwiLFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIHRpbWVNaW4sXG4gICAgICAgIHRpbWVNYXgsXG4gICAgICApO1xuXG4gICAgICBuZXcgTm90aWNlKGBTeW5jZWQgJHtldmVudHMubGVuZ3RofSBldmVudHNgKTtcblxuICAgICAgLy8gVE9ETzogQ2FjaGUgZXZlbnRzIGxvY2FsbHkgZm9yIG9mZmxpbmUgYWNjZXNzXG4gICAgICByZXR1cm47XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzeW5jaW5nIGNhbGVuZGFyOlwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiRmFpbGVkIHRvIHN5bmMgY2FsZW5kYXJcIik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBOb3RpY2UsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7XG4gIEdPT0dMRV9PQVVUSF9DQUxMQkFDS19VUkwsXG4gIFRPS0VOX0VYUElSWV9PUFRJT05TLFxuICBUb2tlbkV4cGlyeU9wdGlvbixcbn0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7IFRva2VuTWFuYWdlciB9IGZyb20gXCIuL3Rva2VuLW1hbmFnZXJcIjtcblxuZXhwb3J0IGNsYXNzIEdvb2dsZVNldHRpbmdzVUkge1xuICAvKipcbiAgICogUmVuZGVyIHNldHVwIGd1aWRlIHdpdGggc3RlcC1ieS1zdGVwIGluc3RydWN0aW9uc1xuICAgKi9cbiAgc3RhdGljIHJlbmRlclNldHVwR3VpZGUoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc2V0dXBTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInBtYy1zZXR1cC1ndWlkZVwiIH0pO1xuICAgIHNldHVwU2VjdGlvbi5jcmVhdGVFbChcImg0XCIsIHsgdGV4dDogXCJcdUQ4M0RcdURDQ0IgU2V0dXAgR3VpZGVcIiB9KTtcblxuICAgIGNvbnN0IHNldHVwU3RlcHMgPSBzZXR1cFNlY3Rpb24uY3JlYXRlRWwoXCJvbFwiKTtcblxuICAgIC8vIFN0ZXAgMTogQ3JlYXRlIEdvb2dsZSBDbG91ZCBQcm9qZWN0XG4gICAgY29uc3Qgc3RlcDEgPSBzZXR1cFN0ZXBzLmNyZWF0ZUVsKFwibGlcIik7XG4gICAgc3RlcDEuY3JlYXRlRWwoXCJzdHJvbmdcIiwgeyB0ZXh0OiBcIkNyZWF0ZSBhIEdvb2dsZSBDbG91ZCBQcm9qZWN0OlwiIH0pO1xuICAgIGNvbnN0IHN0ZXAxTGlzdCA9IHN0ZXAxLmNyZWF0ZUVsKFwidWxcIik7XG4gICAgc3RlcDFMaXN0LmNyZWF0ZUVsKFwibGlcIikuaW5uZXJIVE1MID1cbiAgICAgICdHbyB0byA8YSBocmVmPVwiaHR0cHM6Ly9jb25zb2xlLmNsb3VkLmdvb2dsZS5jb20vXCIgdGFyZ2V0PVwiX2JsYW5rXCI+R29vZ2xlIENsb3VkIENvbnNvbGU8L2E+JztcbiAgICBzdGVwMUxpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XG4gICAgICB0ZXh0OiAnQ2xpY2sgXCJTZWxlY3QgYSBwcm9qZWN0XCIgXHUyMTkyIFwiTmV3IFByb2plY3RcIicsXG4gICAgfSk7XG4gICAgc3RlcDFMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xuICAgICAgdGV4dDogJ0dpdmUgaXQgYSBuYW1lIChlLmcuLCBcIk9ic2lkaWFuIFBNQyBQbHVnaW5cIikgYW5kIGNsaWNrIFwiQ3JlYXRlXCInLFxuICAgIH0pO1xuXG4gICAgLy8gU3RlcCAyOiBFbmFibGUgR29vZ2xlIENhbGVuZGFyIEFQSVxuICAgIGNvbnN0IHN0ZXAyID0gc2V0dXBTdGVwcy5jcmVhdGVFbChcImxpXCIpO1xuICAgIHN0ZXAyLmNyZWF0ZUVsKFwic3Ryb25nXCIsIHsgdGV4dDogXCJFbmFibGUgR29vZ2xlIENhbGVuZGFyIEFQSTpcIiB9KTtcbiAgICBjb25zdCBzdGVwMkxpc3QgPSBzdGVwMi5jcmVhdGVFbChcInVsXCIpO1xuICAgIHN0ZXAyTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcbiAgICAgIHRleHQ6ICdJbiB0aGUgc2lkZWJhciwgZ28gdG8gXCJBUElzICYgU2VydmljZXNcIiBcdTIxOTIgXCJMaWJyYXJ5XCInLFxuICAgIH0pO1xuICAgIHN0ZXAyTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogJ1NlYXJjaCBmb3IgXCJHb29nbGUgQ2FsZW5kYXIgQVBJXCInIH0pO1xuICAgIHN0ZXAyTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogJ0NsaWNrIG9uIGl0IGFuZCBwcmVzcyBcIkVuYWJsZVwiJyB9KTtcblxuICAgIC8vIFN0ZXAgMzogQ3JlYXRlIE9BdXRoIENyZWRlbnRpYWxzXG4gICAgY29uc3Qgc3RlcDMgPSBzZXR1cFN0ZXBzLmNyZWF0ZUVsKFwibGlcIik7XG4gICAgc3RlcDMuY3JlYXRlRWwoXCJzdHJvbmdcIiwgeyB0ZXh0OiBcIkNyZWF0ZSBPQXV0aCAyLjAgQ3JlZGVudGlhbHM6XCIgfSk7XG4gICAgY29uc3Qgc3RlcDNMaXN0ID0gc3RlcDMuY3JlYXRlRWwoXCJ1bFwiKTtcbiAgICBzdGVwM0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XG4gICAgICB0ZXh0OiAnR28gdG8gXCJBUElzICYgU2VydmljZXNcIiBcdTIxOTIgXCJDcmVkZW50aWFsc1wiJyxcbiAgICB9KTtcbiAgICBzdGVwM0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XG4gICAgICB0ZXh0OiAnQ2xpY2sgXCJDcmVhdGUgQ3JlZGVudGlhbHNcIiBcdTIxOTIgXCJPQXV0aCBjbGllbnQgSURcIicsXG4gICAgfSk7XG4gICAgc3RlcDNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xuICAgICAgdGV4dDogXCJJZiBwcm9tcHRlZCwgY29uZmlndXJlIHRoZSBPQXV0aCBjb25zZW50IHNjcmVlbiBmaXJzdFwiLFxuICAgIH0pO1xuICAgIHN0ZXAzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcbiAgICAgIHRleHQ6ICdTZWxlY3QgXCJXZWIgYXBwbGljYXRpb25cIiBhcyB0aGUgYXBwbGljYXRpb24gdHlwZScsXG4gICAgfSk7XG4gICAgc3RlcDNMaXN0XG4gICAgICAuY3JlYXRlRWwoXCJsaVwiLCB7IHRleHQ6IFwiQWRkIHRoaXMgQXV0aG9yaXplZCByZWRpcmVjdCBVUkk6IFwiIH0pXG4gICAgICAuY3JlYXRlRWwoXCJjb2RlXCIsIHsgdGV4dDogR09PR0xFX09BVVRIX0NBTExCQUNLX1VSTCB9KTtcbiAgICBzdGVwM0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XG4gICAgICB0ZXh0OiAnQ2xpY2sgXCJDcmVhdGVcIiBhbmQgY29weSB5b3VyIENsaWVudCBJRCcsXG4gICAgfSk7XG5cbiAgICAvLyBTdGVwIDQ6IENvbmZpZ3VyZSBwbHVnaW5cbiAgICBjb25zdCBzdGVwNCA9IHNldHVwU3RlcHMuY3JlYXRlRWwoXCJsaVwiKTtcbiAgICBzdGVwNC5jcmVhdGVFbChcInN0cm9uZ1wiLCB7XG4gICAgICB0ZXh0OiBcIlBhc3RlIHRoZSBDbGllbnQgSUQgYmVsb3cgYW5kIGNsaWNrIENvbm5lY3RcIixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgT0F1dGggY2FsbGJhY2sgVVJMIHNldHRpbmdcbiAgICovXG4gIHN0YXRpYyByZW5kZXJDYWxsYmFja1VybFNldHRpbmcoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIk9BdXRoIENhbGxiYWNrIFVSTFwiKVxuICAgICAgLnNldERlc2MoXCJVc2UgdGhpcyBVUkwgd2hlbiBjb25maWd1cmluZyB5b3VyIEdvb2dsZSBPQXV0aCBhcHBsaWNhdGlvblwiKVxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIHRleHQuc2V0VmFsdWUoR09PR0xFX09BVVRIX0NBTExCQUNLX1VSTCkuc2V0RGlzYWJsZWQodHJ1ZSksXG4gICAgICApXG4gICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KFwiQ29weVwiKS5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChHT09HTEVfT0FVVEhfQ0FMTEJBQ0tfVVJMKTtcbiAgICAgICAgICBuZXcgTm90aWNlKFwiQ2FsbGJhY2sgVVJMIGNvcGllZCB0byBjbGlwYm9hcmQhXCIpO1xuICAgICAgICB9KSxcbiAgICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIENsaWVudCBJRCBpbnB1dCBzZXR0aW5nXG4gICAqL1xuICBzdGF0aWMgcmVuZGVyQ2xpZW50SWRTZXR0aW5nKFxuICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICBjdXJyZW50Q2xpZW50SWQ6IHN0cmluZyxcbiAgICBvblNhdmU6IChjbGllbnRJZDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+LFxuICApOiB2b2lkIHtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiQ2xpZW50IElEXCIpXG4gICAgICAuc2V0RGVzYyhcIk9BdXRoIDIuMCBDbGllbnQgSUQgZnJvbSBHb29nbGUgQ2xvdWQgQ29uc29sZVwiKVxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIHRleHRcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCIxMjM0NTY3ODktYWJjZGVmZy5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbVwiKVxuICAgICAgICAgIC5zZXRWYWx1ZShjdXJyZW50Q2xpZW50SWQpXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgb25TYXZlKHZhbHVlLnRyaW0oKSk7XG4gICAgICAgICAgfSksXG4gICAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmRlciB0b2tlbiBleHBpcnkgZHJvcGRvd24gc2V0dGluZ1xuICAgKi9cbiAgc3RhdGljIHJlbmRlclRva2VuRXhwaXJ5U2V0dGluZyhcbiAgICBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgY3VycmVudEV4cGlyeTogVG9rZW5FeHBpcnlPcHRpb24sXG4gICAgb25TYXZlOiAoZXhwaXJ5OiBUb2tlbkV4cGlyeU9wdGlvbikgPT4gUHJvbWlzZTx2b2lkPixcbiAgKTogdm9pZCB7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlRva2VuIEV4cGlyeVwiKVxuICAgICAgLnNldERlc2MoXG4gICAgICAgIFwiSG93IGxvbmcgYmVmb3JlIHRoZSBhY2Nlc3MgdG9rZW4gZXhwaXJlcyBhbmQgcmVxdWlyZXMgcmUtYXV0aGVudGljYXRpb25cIixcbiAgICAgIClcbiAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoVE9LRU5fRVhQSVJZX09QVElPTlMpLmZvckVhY2goKFtrZXksIGxhYmVsXSkgPT4ge1xuICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihrZXksIGxhYmVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZHJvcGRvd24uc2V0VmFsdWUoY3VycmVudEV4cGlyeSkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgYXdhaXQgb25TYXZlKHZhbHVlIGFzIFRva2VuRXhwaXJ5T3B0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXIgdG9rZW4gc3RhdHVzIGluZm9ybWF0aW9uXG4gICAqL1xuICBzdGF0aWMgcmVuZGVyVG9rZW5TdGF0dXMoXG4gICAgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgIGV4cGlyeURhdGU6IG51bWJlciB8IHVuZGVmaW5lZCxcbiAgKTogdm9pZCB7XG4gICAgaWYgKCFleHBpcnlEYXRlKSByZXR1cm47XG5cbiAgICBjb25zdCB0aW1lUmVtYWluaW5nID0gVG9rZW5NYW5hZ2VyLmdldFRpbWVSZW1haW5pbmcoZXhwaXJ5RGF0ZSk7XG4gICAgY29uc3QgaXNFeHBpcmVkID0gVG9rZW5NYW5hZ2VyLmlzVG9rZW5FeHBpcmVkKGV4cGlyeURhdGUpO1xuICAgIGNvbnN0IG5lZWRzUmVmcmVzaCA9IFRva2VuTWFuYWdlci5uZWVkc1JlZnJlc2hTb29uKGV4cGlyeURhdGUpO1xuXG4gICAgY29uc3Qgc3RhdHVzVGV4dCA9IGlzRXhwaXJlZFxuICAgICAgPyBcIlx1MjZBMFx1RkUwRiBUb2tlbiBleHBpcmVkXCJcbiAgICAgIDogbmVlZHNSZWZyZXNoXG4gICAgICAgID8gYFx1MjZBMFx1RkUwRiBUb2tlbiBleHBpcmVzIGluICR7dGltZVJlbWFpbmluZ31gXG4gICAgICAgIDogYFRva2VuIHZhbGlkIGZvciAke3RpbWVSZW1haW5pbmd9YDtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiVG9rZW4gU3RhdHVzXCIpLnNldERlc2Moc3RhdHVzVGV4dCk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVyIGFjY291bnQgY29ubmVjdGlvbiBzZXR0aW5nIHdpdGggYnV0dG9uc1xuICAgKi9cbiAgc3RhdGljIHJlbmRlckFjY291bnRTZXR0aW5nKFxuICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICBpc0Nvbm5lY3RlZDogYm9vbGVhbixcbiAgICBjbGllbnRJZDogc3RyaW5nLFxuICAgIG9uQ29ubmVjdDogKCkgPT4gdm9pZCxcbiAgICBvbkRpc2Nvbm5lY3Q6ICgpID0+IFByb21pc2U8dm9pZD4sXG4gICAgb25TeW5jOiAoKSA9PiBQcm9taXNlPHZvaWQ+LFxuICApOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZyhcImlzIGNvbm5lY3RlZDpcIiwgaXNDb25uZWN0ZWQpO1xuXG4gICAgY29uc3QgYWNjb3VudFNldHRpbmcgPSBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiQWNjb3VudFwiKVxuICAgICAgLnNldERlc2MoaXNDb25uZWN0ZWQgPyBcIlx1MjcwNSBDb25uZWN0ZWRcIiA6IFwiXHUyNzRDIE5vdCBDb25uZWN0ZWRcIik7XG5cbiAgICBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICAgIC8vIFN5bmMgQ2FsZW5kYXIgYnV0dG9uXG4gICAgICBhY2NvdW50U2V0dGluZy5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoXCJTeW5jIENhbGVuZGFyXCIpLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGF3YWl0IG9uU3luYygpO1xuICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAgIC8vIERpc2Nvbm5lY3QgYnV0dG9uXG4gICAgICBhY2NvdW50U2V0dGluZy5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgYnRuXG4gICAgICAgICAgLnNldFdhcm5pbmcoKVxuICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiRGlzY29ubmVjdFwiKVxuICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IG9uRGlzY29ubmVjdCgpO1xuICAgICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU2hvdyB3YXJuaW5nIGlmIG5vIENsaWVudCBJRFxuICAgICAgaWYgKCFjbGllbnRJZCB8fCBjbGllbnRJZCA9PT0gXCJcIikge1xuICAgICAgICBhY2NvdW50U2V0dGluZy5zZXREZXNjKFwiXHUyNkEwXHVGRTBGIFBsZWFzZSBzZXQgQ2xpZW50IElEIGZpcnN0XCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQ29ubmVjdCBidXR0b25cbiAgICAgICAgYWNjb3VudFNldHRpbmcuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgICAgYnRuXG4gICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQ29ubmVjdCB0byBHb29nbGVcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgb25Db25uZWN0KCk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsICIvKipcbiAqIFRva2VuIGV4cGlyeSBhbmQgcmVmcmVzaCBtYW5hZ2VtZW50IGZvciBHb29nbGUgQ2FsZW5kYXJcbiAqL1xuXG5pbXBvcnQgeyBUb2tlbkV4cGlyeU9wdGlvbiB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBUb2tlbk1hbmFnZXIge1xuICAvKipcbiAgICogQ2FsY3VsYXRlIHRva2VuIGV4cGlyeSBkYXRlIGJhc2VkIG9uIHRoZSBzZWxlY3RlZCBvcHRpb25cbiAgICogQHBhcmFtIGV4cGlyeU9wdGlvbiAtIFRoZSBleHBpcnkgb3B0aW9uIHNlbGVjdGVkIGJ5IHRoZSB1c2VyXG4gICAqIEByZXR1cm5zIFVuaXggdGltZXN0YW1wIHdoZW4gdG9rZW4gZXhwaXJlcywgb3IgdW5kZWZpbmVkIGZvciB1bmxpbWl0ZWRcbiAgICovXG4gIHN0YXRpYyBjYWxjdWxhdGVFeHBpcnlEYXRlKGV4cGlyeU9wdGlvbjogVG9rZW5FeHBpcnlPcHRpb24pOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIGlmIChleHBpcnlPcHRpb24gPT09IFwidW5saW1pdGVkXCIpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBtaWxsaXNlY29uZHNQZXJEYXkgPSAyNCAqIDYwICogNjAgKiAxMDAwO1xuXG4gICAgc3dpdGNoIChleHBpcnlPcHRpb24pIHtcbiAgICAgIGNhc2UgXCIxd2Vla1wiOlxuICAgICAgICByZXR1cm4gbm93ICsgNyAqIG1pbGxpc2Vjb25kc1BlckRheTtcbiAgICAgIGNhc2UgXCIxbW9udGhcIjpcbiAgICAgICAgcmV0dXJuIG5vdyArIDMwICogbWlsbGlzZWNvbmRzUGVyRGF5O1xuICAgICAgY2FzZSBcIjNtb250aHNcIjpcbiAgICAgICAgcmV0dXJuIG5vdyArIDkwICogbWlsbGlzZWNvbmRzUGVyRGF5O1xuICAgICAgY2FzZSBcIjZtb250aHNcIjpcbiAgICAgICAgcmV0dXJuIG5vdyArIDE4MCAqIG1pbGxpc2Vjb25kc1BlckRheTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHRoZSB0b2tlbiBoYXMgZXhwaXJlZFxuICAgKiBAcGFyYW0gZXhwaXJ5RGF0ZSAtIFVuaXggdGltZXN0YW1wIHdoZW4gdG9rZW4gZXhwaXJlc1xuICAgKiBAcmV0dXJucyB0cnVlIGlmIHRva2VuIGlzIGV4cGlyZWQsIGZhbHNlIG90aGVyd2lzZVxuICAgKi9cbiAgc3RhdGljIGlzVG9rZW5FeHBpcmVkKGV4cGlyeURhdGU6IG51bWJlciB8IHVuZGVmaW5lZCk6IGJvb2xlYW4ge1xuICAgIGlmICghZXhwaXJ5RGF0ZSkge1xuICAgICAgcmV0dXJuIGZhbHNlOyAvLyBVbmxpbWl0ZWQgdG9rZW5zIG5ldmVyIGV4cGlyZVxuICAgIH1cblxuICAgIHJldHVybiBEYXRlLm5vdygpID49IGV4cGlyeURhdGU7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGh1bWFuLXJlYWRhYmxlIHRpbWUgcmVtYWluaW5nIHVudGlsIHRva2VuIGV4cGlyZXNcbiAgICogQHBhcmFtIGV4cGlyeURhdGUgLSBVbml4IHRpbWVzdGFtcCB3aGVuIHRva2VuIGV4cGlyZXNcbiAgICogQHJldHVybnMgRm9ybWF0dGVkIHN0cmluZyBsaWtlIFwiNSBkYXlzXCIsIFwiMiBob3Vyc1wiLCBvciBcIlVubGltaXRlZFwiXG4gICAqL1xuICBzdGF0aWMgZ2V0VGltZVJlbWFpbmluZyhleHBpcnlEYXRlOiBudW1iZXIgfCB1bmRlZmluZWQpOiBzdHJpbmcge1xuICAgIGlmICghZXhwaXJ5RGF0ZSkge1xuICAgICAgcmV0dXJuIFwiVW5saW1pdGVkXCI7XG4gICAgfVxuXG4gICAgY29uc3QgcmVtYWluaW5nID0gZXhwaXJ5RGF0ZSAtIERhdGUubm93KCk7XG5cbiAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgIHJldHVybiBcIkV4cGlyZWRcIjtcbiAgICB9XG5cbiAgICBjb25zdCBkYXlzID0gTWF0aC5mbG9vcihyZW1haW5pbmcgLyAoMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcigocmVtYWluaW5nICUgKDI0ICogNjAgKiA2MCAqIDEwMDApKSAvICg2MCAqIDYwICogMTAwMCkpO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChyZW1haW5pbmcgJSAoNjAgKiA2MCAqIDEwMDApKSAvICg2MCAqIDEwMDApKTtcblxuICAgIGlmIChkYXlzID4gMCkge1xuICAgICAgcmV0dXJuIGAke2RheXN9IGRheSR7ZGF5cyAhPT0gMSA/IFwic1wiIDogXCJcIn1gO1xuICAgIH0gZWxzZSBpZiAoaG91cnMgPiAwKSB7XG4gICAgICByZXR1cm4gYCR7aG91cnN9IGhvdXIke2hvdXJzICE9PSAxID8gXCJzXCIgOiBcIlwifWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgJHttaW51dGVzfSBtaW51dGUke21pbnV0ZXMgIT09IDEgPyBcInNcIiA6IFwiXCJ9YDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgdG9rZW4gbmVlZHMgcmVmcmVzaCBzb29uICh3aXRoaW4gMjQgaG91cnMpXG4gICAqIEBwYXJhbSBleHBpcnlEYXRlIC0gVW5peCB0aW1lc3RhbXAgd2hlbiB0b2tlbiBleHBpcmVzXG4gICAqIEByZXR1cm5zIHRydWUgaWYgdG9rZW4gZXhwaXJlcyB3aXRoaW4gMjQgaG91cnNcbiAgICovXG4gIHN0YXRpYyBuZWVkc1JlZnJlc2hTb29uKGV4cGlyeURhdGU6IG51bWJlciB8IHVuZGVmaW5lZCk6IGJvb2xlYW4ge1xuICAgIGlmICghZXhwaXJ5RGF0ZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IG9uZURheUluTXMgPSAyNCAqIDYwICogNjAgKiAxMDAwO1xuICAgIGNvbnN0IHJlbWFpbmluZyA9IGV4cGlyeURhdGUgLSBEYXRlLm5vdygpO1xuXG4gICAgcmV0dXJuIHJlbWFpbmluZyA+IDAgJiYgcmVtYWluaW5nIDwgb25lRGF5SW5NcztcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXQgZXhwaXJ5IGRhdGUgdG8gcmVhZGFibGUgc3RyaW5nXG4gICAqIEBwYXJhbSBleHBpcnlEYXRlIC0gVW5peCB0aW1lc3RhbXAgd2hlbiB0b2tlbiBleHBpcmVzXG4gICAqIEByZXR1cm5zIEZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuICAgKi9cbiAgc3RhdGljIGZvcm1hdEV4cGlyeURhdGUoZXhwaXJ5RGF0ZTogbnVtYmVyIHwgdW5kZWZpbmVkKTogc3RyaW5nIHtcbiAgICBpZiAoIWV4cGlyeURhdGUpIHtcbiAgICAgIHJldHVybiBcIk5ldmVyXCI7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGV4cGlyeURhdGUpO1xuICAgIHJldHVybiBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZyh1bmRlZmluZWQsIHtcbiAgICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICAgICAgbW9udGg6IFwibG9uZ1wiLFxuICAgICAgZGF5OiBcIm51bWVyaWNcIixcbiAgICAgIGhvdXI6IFwiMi1kaWdpdFwiLFxuICAgICAgbWludXRlOiBcIjItZGlnaXRcIixcbiAgICB9KTtcbiAgfVxufVxuIiwgImltcG9ydCB7XG4gIEFwcCxcbiAgRWRpdG9yLFxuICBFZGl0b3JQb3NpdGlvbixcbiAgRWRpdG9yU3VnZ2VzdCxcbiAgRWRpdG9yU3VnZ2VzdENvbnRleHQsXG4gIEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyxcbiAgVEZpbGUsXG4gIE5vdGljZSxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgUE1DUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBHb29nbGVDYWxlbmRhckFQSSwgQ2FsZW5kYXJFdmVudCB9IGZyb20gXCIuL3RhYnMvZ29vZ2xlXCI7XG5pbXBvcnQgeyBDcmVhdGVFdmVudE1vZGFsIH0gZnJvbSBcIi4vY3JlYXRlLWV2ZW50XCI7XG5cbmludGVyZmFjZSBFdmVudFN1Z2dlc3Rpb24ge1xuICBpc0NyZWF0ZT86IGJvb2xlYW47XG4gIGV2ZW50PzogQ2FsZW5kYXJFdmVudDtcbiAgc3VtbWFyeTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgRWRpdG9yRXZlbnRTdWdnZXN0aW9uIGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxFdmVudFN1Z2dlc3Rpb24+IHtcbiAgcGx1Z2luOiBQTUNQbHVnaW47XG4gIHByaXZhdGUgY2FjaGVkRXZlbnRzOiBDYWxlbmRhckV2ZW50W10gPSBbXTtcbiAgcHJpdmF0ZSBsYXN0RmV0Y2hUaW1lOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIHJlYWRvbmx5IENBQ0hFX0RVUkFUSU9OID0gNSAqIDYwICogMTAwMDsgLy8gNSBtaW51dGVzXG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUE1DUGx1Z2luKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIG9uVHJpZ2dlcihcbiAgICBjdXJzb3I6IEVkaXRvclBvc2l0aW9uLFxuICAgIGVkaXRvcjogRWRpdG9yLFxuICAgIGZpbGU6IFRGaWxlLFxuICApOiBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8gfCBudWxsIHtcbiAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuICAgIGNvbnN0IHRleHRCZWZvcmVDdXJzb3IgPSBsaW5lLnN1YnN0cmluZygwLCBjdXJzb3IuY2gpO1xuXG4gICAgaWYgKHRleHRCZWZvcmVDdXJzb3IuZW5kc1dpdGgoXCI6XCIpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGFydDogeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSxcbiAgICAgICAgZW5kOiBjdXJzb3IsXG4gICAgICAgIHF1ZXJ5OiBcIlwiLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hFdmVudHNXaXRoQ2FjaGUocXVlcnk/OiBzdHJpbmcpOiBQcm9taXNlPENhbGVuZGFyRXZlbnRbXT4ge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgY29uc3Qgc2hvdWxkUmVmZXRjaCA9IG5vdyAtIHRoaXMubGFzdEZldGNoVGltZSA+IHRoaXMuQ0FDSEVfRFVSQVRJT047XG5cbiAgICBpZiAoc2hvdWxkUmVmZXRjaCB8fCB0aGlzLmNhY2hlZEV2ZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEZldGNoIGV2ZW50cyBmb3IgdGhlIG5leHQgMzAgZGF5cyBhbmQgcGFzdCA3IGRheXNcbiAgICAgICAgY29uc3QgdGltZU1pbiA9IG5ldyBEYXRlKFxuICAgICAgICAgIERhdGUubm93KCkgLSA3ICogMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgICAgKS50b0lTT1N0cmluZygpO1xuICAgICAgICBjb25zdCB0aW1lTWF4ID0gbmV3IERhdGUoXG4gICAgICAgICAgRGF0ZS5ub3coKSArIHRoaXMucGx1Z2luLnNldHRpbmdzLnRpbWVSYW5nZSAqIDI0ICogNjAgKiA2MCAqIDEwMDAsXG4gICAgICAgICkudG9JU09TdHJpbmcoKTtcblxuICAgICAgICB0aGlzLmNhY2hlZEV2ZW50cyA9IGF3YWl0IEdvb2dsZUNhbGVuZGFyQVBJLmZldGNoRXZlbnRzKFxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFjY2Vzc1Rva2VuLFxuICAgICAgICAgIFwicHJpbWFyeVwiLFxuICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICB0aW1lTWluLFxuICAgICAgICAgIHRpbWVNYXgsXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMubGFzdEZldGNoVGltZSA9IG5vdztcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBldmVudHM6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNhY2hlZEV2ZW50cztcbiAgfVxuXG4gIHByaXZhdGUgZmlsdGVyRXZlbnRzKFxuICAgIGV2ZW50czogQ2FsZW5kYXJFdmVudFtdLFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICk6IENhbGVuZGFyRXZlbnRbXSB7XG4gICAgaWYgKCFxdWVyeSB8fCBxdWVyeS50cmltKCkgPT09IFwiXCIpIHtcbiAgICAgIHJldHVybiBldmVudHM7XG4gICAgfVxuXG4gICAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuXG4gICAgcmV0dXJuIGV2ZW50cy5maWx0ZXIoKGV2ZW50KSA9PiB7XG4gICAgICAvLyBTZWFyY2ggaW4gc3VtbWFyeVxuICAgICAgaWYgKGV2ZW50LnN1bW1hcnk/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFNlYXJjaCBpbiBkZXNjcmlwdGlvblxuICAgICAgaWYgKGV2ZW50LmRlc2NyaXB0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBTZWFyY2ggaW4gbG9jYXRpb25cbiAgICAgIGlmIChldmVudC5sb2NhdGlvbj8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclF1ZXJ5KSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VhcmNoIGluIGF0dGVuZGVlc1xuICAgICAgaWYgKFxuICAgICAgICBldmVudC5hdHRlbmRlZXM/LnNvbWUoXG4gICAgICAgICAgKGF0dGVuZGVlKSA9PlxuICAgICAgICAgICAgYXR0ZW5kZWUuZW1haWw/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkgfHxcbiAgICAgICAgICAgIGF0dGVuZGVlLmRpc3BsYXlOYW1lPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpLFxuICAgICAgICApXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIHJldHVybiBsaXN0IG9mIHN1Z2dlc3Rpb25zXG4gIGFzeW5jIGdldFN1Z2dlc3Rpb25zKFxuICAgIGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0LFxuICApOiBQcm9taXNlPEV2ZW50U3VnZ2VzdGlvbltdPiB7XG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmFjY2Vzc1Rva2VuID09PSBcIlwiKSB7XG4gICAgICBjb25zb2xlLmxvZyhcImNvbm5lY3QgZ29vZ2xlIGNhbGVuZGFyIGZpcnN0XCIpO1xuICAgICAgbmV3IE5vdGljZShcIlBsZWFzZSBjb25uZWN0IHRvIEdvb2dsZSBDYWxlbmRhciBmaXJzdFwiKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBxdWVyeSA9IChjb250ZXh0LnF1ZXJ5IHx8IFwiXCIpLnRyaW0oKTtcbiAgICB0cnkge1xuICAgICAgLy8gRmV0Y2ggYWxsIGV2ZW50cyBmcm9tIGNhY2hlXG4gICAgICBjb25zdCBhbGxFdmVudHMgPSBhd2FpdCB0aGlzLmZldGNoRXZlbnRzV2l0aENhY2hlKCk7XG5cbiAgICAgIC8vIEZpbHRlciBldmVudHMgYmFzZWQgb24gcXVlcnlcbiAgICAgIGNvbnN0IGZpbHRlcmVkRXZlbnRzID0gdGhpcy5maWx0ZXJFdmVudHMoYWxsRXZlbnRzLCBxdWVyeSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFwiZmlsdGVyZWQgZXZlbnRzXCIsIGZpbHRlcmVkRXZlbnRzKTtcblxuICAgICAgLy8gUmV0dXJuIGNyZWF0ZSBvcHRpb24gKyBmaWx0ZXJlZCBldmVudHNcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBFdmVudFN1Z2dlc3Rpb25bXSA9IFtdO1xuXG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAuLi5maWx0ZXJlZEV2ZW50cy5tYXAoKGV2ZW50KSA9PiAoe1xuICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgIHN1bW1hcnk6IGV2ZW50LnN1bW1hcnkgfHwgZXZlbnQuZGVzY3JpcHRpb24gfHwgXCJVbnRpdGxlZCBFdmVudFwiLFxuICAgICAgICB9KSksXG4gICAgICApO1xuXG4gICAgICByZXR1cm4gW1xuICAgICAgICB7XG4gICAgICAgICAgaXNDcmVhdGU6IHRydWUsXG4gICAgICAgICAgc3VtbWFyeTogYCsgQ3JlYXRlIG5ldyBldmVudGAsXG4gICAgICAgIH0sXG4gICAgICAgIC4uLnN1Z2dlc3Rpb25zLFxuICAgICAgXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdldHRpbmcgc3VnZ2VzdGlvbnM6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvLyByZW5kZXIgZWFjaCBzdWdnZXN0aW9uXG4gIHJlbmRlclN1Z2dlc3Rpb24oaXRlbTogRXZlbnRTdWdnZXN0aW9uLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBlbC5lbXB0eSgpO1xuXG4gICAgY29uc3QgY29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcImdjYWwtc3VnZ2VzdGlvbi1jb250YWluZXJcIiB9KTtcbiAgICBjb250YWluZXIuc3R5bGUuY3NzVGV4dCA9XG4gICAgICBcImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZzogNHB4IDA7XCI7XG5cbiAgICBpZiAoaXRlbS5pc0NyZWF0ZSkge1xuICAgICAgY29udGFpbmVyLnN0eWxlLmNzc1RleHQgKz1cbiAgICAgICAgXCJjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgZm9udC13ZWlnaHQ6IDYwMDtcIjtcbiAgICAgIGNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBpdGVtLnN1bW1hcnkgfSk7XG4gICAgfSBlbHNlIGlmIChpdGVtLmV2ZW50KSB7XG4gICAgICBjb25zdCBldmVudCA9IGl0ZW0uZXZlbnQ7XG4gICAgICBjb25zdCBsZWZ0RGl2ID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgbGVmdERpdi5zdHlsZS5jc3NUZXh0ID0gXCJmbGV4OiAxOyBtaW4td2lkdGg6IDA7XCI7XG5cbiAgICAgIC8vIEV2ZW50IHRpdGxlXG4gICAgICBjb25zdCB0aXRsZUVsID0gbGVmdERpdi5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgIHRleHQ6IGV2ZW50LnN1bW1hcnkgfHwgXCJVbnRpdGxlZCBFdmVudFwiLFxuICAgICAgICBjbHM6IFwiZ2NhbC1ldmVudC10aXRsZVwiLFxuICAgICAgfSk7XG4gICAgICB0aXRsZUVsLnN0eWxlLmNzc1RleHQgPVxuICAgICAgICBcImZvbnQtd2VpZ2h0OiA1MDA7IG92ZXJmbG93OiBoaWRkZW47IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyB3aGl0ZS1zcGFjZTogbm93cmFwO1wiO1xuXG4gICAgICAvLyBBZGQgbG9jYXRpb24gaWYgYXZhaWxhYmxlXG4gICAgICBpZiAoZXZlbnQubG9jYXRpb24pIHtcbiAgICAgICAgY29uc3QgbG9jYXRpb25FbCA9IGxlZnREaXYuY3JlYXRlRWwoXCJkaXZcIiwge1xuICAgICAgICAgIHRleHQ6IGV2ZW50LmxvY2F0aW9uLFxuICAgICAgICAgIGNsczogXCJnY2FsLWV2ZW50LWxvY2F0aW9uXCIsXG4gICAgICAgIH0pO1xuICAgICAgICBsb2NhdGlvbkVsLnN0eWxlLmNzc1RleHQgPVxuICAgICAgICAgIFwiZm9udC1zaXplOiAwLjhlbTsgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpOyBvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgbWFyZ2luLXRvcDogMnB4O1wiO1xuICAgICAgfVxuXG4gICAgICAvLyBEYXRlIGFuZCB0aW1lIG9uIHRoZSByaWdodFxuICAgICAgY29uc3QgcmlnaHREaXYgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICByaWdodERpdi5zdHlsZS5jc3NUZXh0ID1cbiAgICAgICAgXCJmbGV4LXNocmluazogMDsgbWFyZ2luLWxlZnQ6IDEycHg7IHRleHQtYWxpZ246IHJpZ2h0O1wiO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShcbiAgICAgICAgICBldmVudC5zdGFydC5kYXRlVGltZSB8fCBldmVudC5zdGFydC5kYXRlIHx8IFwiXCIsXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IGlzVG9kYXkgPSBzdGFydERhdGUudG9EYXRlU3RyaW5nKCkgPT09IG5vdy50b0RhdGVTdHJpbmcoKTtcbiAgICAgICAgY29uc3QgaXNUb21vcnJvdyA9XG4gICAgICAgICAgc3RhcnREYXRlLnRvRGF0ZVN0cmluZygpID09PVxuICAgICAgICAgIG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgKyA4NjQwMDAwMCkudG9EYXRlU3RyaW5nKCk7XG5cbiAgICAgICAgLy8gRm9ybWF0IGRhdGVcbiAgICAgICAgbGV0IGRhdGVTdHIgPSBcIlwiO1xuICAgICAgICBpZiAoaXNUb2RheSkge1xuICAgICAgICAgIGRhdGVTdHIgPSBcIlRvZGF5XCI7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNUb21vcnJvdykge1xuICAgICAgICAgIGRhdGVTdHIgPSBcIlRvbW9ycm93XCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF0ZVN0ciA9IHN0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoW10sIHtcbiAgICAgICAgICAgIG1vbnRoOiBcInNob3J0XCIsXG4gICAgICAgICAgICBkYXk6IFwibnVtZXJpY1wiLFxuICAgICAgICAgICAgeWVhcjpcbiAgICAgICAgICAgICAgc3RhcnREYXRlLmdldEZ1bGxZZWFyKCkgIT09IG5vdy5nZXRGdWxsWWVhcigpXG4gICAgICAgICAgICAgICAgPyBcIm51bWVyaWNcIlxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHRpbWVTdHIgPSBcIlwiO1xuICAgICAgICBpZiAoZXZlbnQuc3RhcnQuZGF0ZVRpbWUpIHtcbiAgICAgICAgICB0aW1lU3RyID0gc3RhcnREYXRlLnRvTG9jYWxlVGltZVN0cmluZyhbXSwge1xuICAgICAgICAgICAgaG91cjogXCJudW1lcmljXCIsXG4gICAgICAgICAgICBtaW51dGU6IFwiMi1kaWdpdFwiLFxuICAgICAgICAgICAgaG91cjEyOiB0cnVlLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRpbWVTdHIgPSBcIkFsbCBkYXlcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERpc3BsYXkgZGF0ZVxuICAgICAgICBjb25zdCBkYXRlRWwgPSByaWdodERpdi5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgICAgdGV4dDogZGF0ZVN0cixcbiAgICAgICAgICBjbHM6IFwiZ2NhbC1ldmVudC1kYXRlXCIsXG4gICAgICAgIH0pO1xuICAgICAgICBkYXRlRWwuc3R5bGUuY3NzVGV4dCA9IFwiZm9udC1zaXplOiAwLjg1ZW07IGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcIjtcblxuICAgICAgICAvLyBEaXNwbGF5IHRpbWVcbiAgICAgICAgY29uc3QgdGltZUVsID0gcmlnaHREaXYuY3JlYXRlRWwoXCJkaXZcIiwge1xuICAgICAgICAgIHRleHQ6IHRpbWVTdHIsXG4gICAgICAgICAgY2xzOiBcImdjYWwtZXZlbnQtdGltZVwiLFxuICAgICAgICB9KTtcbiAgICAgICAgdGltZUVsLnN0eWxlLmNzc1RleHQgPSBcImZvbnQtc2l6ZTogMC45ZW07IGZvbnQtd2VpZ2h0OiA1MDA7XCI7XG5cbiAgICAgICAgLy8gQWRkIGNvbmZlcmVuY2UgaW5kaWNhdG9yIGlmIGF2YWlsYWJsZVxuICAgICAgICBpZiAoZXZlbnQuaGFuZ291dExpbmsgfHwgZXZlbnQuY29uZmVyZW5jZURhdGEpIHtcbiAgICAgICAgICBjb25zdCBjb25mZXJlbmNlRWwgPSByaWdodERpdi5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBcIlx1RDgzQ1x1REZBNSBWaWRlb1wiLFxuICAgICAgICAgICAgY2xzOiBcImdjYWwtZXZlbnQtY29uZmVyZW5jZVwiLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbmZlcmVuY2VFbC5zdHlsZS5jc3NUZXh0ID1cbiAgICAgICAgICAgIFwiZm9udC1zaXplOiAwLjc1ZW07IGNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyBtYXJnaW4tdG9wOiAycHg7XCI7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZvcm1hdHRpbmcgZGF0ZTpcIiwgZSk7XG4gICAgICAgIHJpZ2h0RGl2LmNyZWF0ZUVsKFwic21hbGxcIiwge1xuICAgICAgICAgIHRleHQ6IFwiSW52YWxpZCBkYXRlXCIsXG4gICAgICAgICAgYXR0cjogeyBzdHlsZTogXCJjb2xvcjogdmFyKC0tdGV4dC1lcnJvcik7XCIgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gdXNlciBzZWxlY3RzIGEgc3VnZ2VzdGlvblxuICBzZWxlY3RTdWdnZXN0aW9uKFxuICAgIGl0ZW06IEV2ZW50U3VnZ2VzdGlvbixcbiAgICBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50LFxuICApOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuY29udGV4dCkge1xuICAgICAgY29uc29sZS5lcnJvcihcIk5vIGNvbnRleHQgYXZhaWxhYmxlXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChpdGVtLmlzQ3JlYXRlKSB7XG4gICAgICBuZXcgQ3JlYXRlRXZlbnRNb2RhbChcbiAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICB0aGlzLmNvbnRleHQucXVlcnksXG4gICAgICAgIChldmVudERhdGEpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5jb250ZXh0KSB7XG4gICAgICAgICAgICAvLyBJbnNlcnQgdGhlIGNyZWF0ZWQgZXZlbnQgYXMgYSBsaW5rXG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRUZXh0ID0gYFske2V2ZW50RGF0YS50aXRsZX1dKCR7ZXZlbnREYXRhLmxpbmt9KWA7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuZWRpdG9yLnJlcGxhY2VSYW5nZShcbiAgICAgICAgICAgICAgZm9ybWF0dGVkVGV4dCxcbiAgICAgICAgICAgICAgdGhpcy5jb250ZXh0LnN0YXJ0LFxuICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuZW5kLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICApLm9wZW4oKTtcbiAgICB9IGVsc2UgaWYgKGl0ZW0uZXZlbnQpIHtcbiAgICAgIGNvbnN0IGV2ZW50ID0gaXRlbS5ldmVudDtcbiAgICAgIGNvbnN0IGV2ZW50TGluayA9XG4gICAgICAgIGV2ZW50Lmh0bWxMaW5rIHx8XG4gICAgICAgIGBodHRwczovL2NhbGVuZGFyLmdvb2dsZS5jb20vY2FsZW5kYXIvZXZlbnQ/ZWlkPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGV2ZW50LmlkKX1gO1xuXG4gICAgICBjb25zdCBldmVudFRpdGxlID0gZXZlbnQuc3VtbWFyeSB8fCBcIlVudGl0bGVkIEV2ZW50XCI7XG5cbiAgICAgIC8vIEZvcm1hdDogW0V2ZW50IE5hbWVdKEdvb2dsZSBDYWxlbmRhciBMaW5rKVxuICAgICAgY29uc3QgZm9ybWF0dGVkVGV4dCA9IGBbJHtldmVudFRpdGxlfV0oJHtldmVudExpbmt9KWA7XG5cbiAgICAgIHRoaXMuY29udGV4dC5lZGl0b3IucmVwbGFjZVJhbmdlKFxuICAgICAgICBmb3JtYXR0ZWRUZXh0LFxuICAgICAgICB0aGlzLmNvbnRleHQuc3RhcnQsXG4gICAgICAgIHRoaXMuY29udGV4dC5lbmQsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8vIENsZWFyIGNhY2hlIHdoZW4gbmVlZGVkIChjYW4gYmUgY2FsbGVkIGZyb20gcGx1Z2luKVxuICBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuY2FjaGVkRXZlbnRzID0gW107XG4gICAgdGhpcy5sYXN0RmV0Y2hUaW1lID0gMDtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIE5vdGljZSwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IFBpY2tNZWV0aW5nQ2FsZW5kYXIgZnJvbSBcIi4uL21haW5cIjtcbmltcG9ydCB7IEdvb2dsZUNhbGVuZGFyQVBJLCBUb2tlbk1hbmFnZXIgfSBmcm9tIFwiLi90YWJzL2dvb2dsZVwiO1xuXG5leHBvcnQgY2xhc3MgQ3JlYXRlRXZlbnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgcGx1Z2luOiBQaWNrTWVldGluZ0NhbGVuZGFyO1xuICBpbml0aWFsVGl0bGU6IHN0cmluZztcbiAgb25TdWJtaXQ6IChldmVudERhdGE6IHsgdGl0bGU6IHN0cmluZzsgbGluazogc3RyaW5nIH0pID0+IHZvaWQ7XG5cbiAgLy8gRm9ybSBmaWVsZHNcbiAgdGl0bGU6IHN0cmluZztcbiAgZGF0ZTogc3RyaW5nO1xuICBzdGFydFRpbWU6IHN0cmluZztcbiAgZW5kVGltZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBpc0FsbERheTogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBhcHA6IEFwcCxcbiAgICBwbHVnaW46IFBpY2tNZWV0aW5nQ2FsZW5kYXIsXG4gICAgaW5pdGlhbFRpdGxlOiBzdHJpbmcsXG4gICAgb25TdWJtaXQ6IChldmVudERhdGE6IHsgdGl0bGU6IHN0cmluZzsgbGluazogc3RyaW5nIH0pID0+IHZvaWQsXG4gICkge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5pbml0aWFsVGl0bGUgPSBpbml0aWFsVGl0bGU7XG4gICAgdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xuXG4gICAgLy8gU2V0IGRlZmF1bHRzXG4gICAgdGhpcy50aXRsZSA9IGluaXRpYWxUaXRsZSB8fCBcIlwiO1xuICAgIHRoaXMuaXNBbGxEYXkgPSBmYWxzZTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gXCJcIjtcblxuICAgIC8vIERlZmF1bHQgdG8gdG9kYXlcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIHRoaXMuZGF0ZSA9IG5vdy50b0lTT1N0cmluZygpLnNwbGl0KFwiVFwiKVswXSB8fCBcIlwiO1xuXG4gICAgLy8gRGVmYXVsdCB0aW1lczogbm93ICsgMSBob3VyIGZvciBzdGFydCwgKyAyIGhvdXJzIGZvciBlbmRcbiAgICBjb25zdCBzdGFydEhvdXIgPSAobm93LmdldEhvdXJzKCkgKyAxKSAlIDI0O1xuICAgIGNvbnN0IGVuZEhvdXIgPSAobm93LmdldEhvdXJzKCkgKyAyKSAlIDI0O1xuICAgIHRoaXMuc3RhcnRUaW1lID0gYCR7U3RyaW5nKHN0YXJ0SG91cikucGFkU3RhcnQoMiwgXCIwXCIpfTowMGA7XG4gICAgdGhpcy5lbmRUaW1lID0gYCR7U3RyaW5nKGVuZEhvdXIpLnBhZFN0YXJ0KDIsIFwiMFwiKX06MDBgO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkNyZWF0ZSBDYWxlbmRhciBFdmVudFwiIH0pO1xuXG4gICAgLy8gVGl0bGVcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAuc2V0TmFtZShcIkV2ZW50IHRpdGxlXCIpXG4gICAgICAuc2V0RGVzYyhcIk5hbWUgb2YgdGhlIGV2ZW50XCIpXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgdGV4dFxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIlRlYW0gTWVldGluZ1wiKVxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnRpdGxlKVxuICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGl0bGUgPSB2YWx1ZTtcbiAgICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAvLyBEYXRlXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLnNldE5hbWUoXCJEYXRlXCIpXG4gICAgICAuc2V0RGVzYyhcIkV2ZW50IGRhdGVcIilcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgIHRleHRcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJZWVlZLU1NLUREXCIpXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuZGF0ZSlcbiAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRhdGUgPSB2YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgdGV4dC5pbnB1dEVsLnR5cGUgPSBcImRhdGVcIjtcbiAgICAgIH0pO1xuXG4gICAgLy8gQWxsLWRheSB0b2dnbGVcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAuc2V0TmFtZShcIkFsbC1kYXkgZXZlbnRcIilcbiAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIGZvciBhbGwtZGF5IGV2ZW50c1wiKVxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5pc0FsbERheSkub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5pc0FsbERheSA9IHZhbHVlO1xuICAgICAgICAgIC8vIFRvZ2dsZSB0aW1lIGlucHV0cyB2aXNpYmlsaXR5XG4gICAgICAgICAgY29uc3QgdGltZVNldHRpbmdzID0gY29udGVudEVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGltZS1zZXR0aW5nXCIpO1xuICAgICAgICAgIHRpbWVTZXR0aW5ncy5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgICAgKGVsIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gdmFsdWUgPyBcIm5vbmVcIiA6IFwiZmxleFwiO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAvLyBTdGFydCB0aW1lXG4gICAgY29uc3Qgc3RhcnRUaW1lU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKFwiU3RhcnQgdGltZVwiKVxuICAgICAgLnNldERlc2MoXCJFdmVudCBzdGFydCB0aW1lXCIpXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xuICAgICAgICB0ZXh0XG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiMDk6MDBcIilcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zdGFydFRpbWUpXG4gICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB2YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgdGV4dC5pbnB1dEVsLnR5cGUgPSBcInRpbWVcIjtcbiAgICAgIH0pO1xuICAgIHN0YXJ0VGltZVNldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKFwidGltZS1zZXR0aW5nXCIpO1xuXG4gICAgLy8gRW5kIHRpbWVcbiAgICBjb25zdCBlbmRUaW1lU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKFwiRW5kIHRpbWVcIilcbiAgICAgIC5zZXREZXNjKFwiRXZlbnQgZW5kIHRpbWVcIilcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgIHRleHRcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCIxMDowMFwiKVxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLmVuZFRpbWUpXG4gICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmRUaW1lID0gdmFsdWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgIHRleHQuaW5wdXRFbC50eXBlID0gXCJ0aW1lXCI7XG4gICAgICB9KTtcbiAgICBlbmRUaW1lU2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJ0aW1lLXNldHRpbmdcIik7XG5cbiAgICAvLyBEZXNjcmlwdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKFwiRGVzY3JpcHRpb25cIilcbiAgICAgIC5zZXREZXNjKFwiQWRkaXRpb25hbCBkZXRhaWxzIChvcHRpb25hbClcIilcbiAgICAgIC5hZGRUZXh0QXJlYSgodGV4dCkgPT4ge1xuICAgICAgICB0ZXh0XG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiTWVldGluZyBhZ2VuZGEsIG5vdGVzLCBldGMuXCIpXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMuZGVzY3JpcHRpb24pXG4gICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IHZhbHVlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB0ZXh0LmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuICAgICAgfSk7XG5cbiAgICAvLyBCdXR0b25zXG4gICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwibW9kYWwtYnV0dG9uLWNvbnRhaW5lclwiLFxuICAgIH0pO1xuICAgIGJ1dHRvbkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID1cbiAgICAgIFwiZGlzcGxheTogZmxleDsgZ2FwOiAxMHB4OyBtYXJnaW4tdG9wOiAyMHB4OyBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1wiO1xuXG4gICAgLy8gQ2FuY2VsIGJ1dHRvblxuICAgIGNvbnN0IGNhbmNlbEJ0biA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ2FuY2VsXCIgfSk7XG4gICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG5cbiAgICAvLyBDcmVhdGUgYnV0dG9uXG4gICAgY29uc3QgY3JlYXRlQnRuID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIHRleHQ6IFwiQ3JlYXRlIEV2ZW50XCIsXG4gICAgICBjbHM6IFwibW9kLWN0YVwiLFxuICAgIH0pO1xuICAgIGNyZWF0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jcmVhdGVFdmVudCgpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlRXZlbnQoKSB7XG4gICAgLy8gVmFsaWRhdGUgaW5wdXRzXG4gICAgaWYgKCF0aGlzLnRpdGxlLnRyaW0oKSkge1xuICAgICAgbmV3IE5vdGljZShcIlx1Mjc0QyBFdmVudCB0aXRsZSBpcyByZXF1aXJlZFwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZGF0ZSkge1xuICAgICAgbmV3IE5vdGljZShcIlx1Mjc0QyBFdmVudCBkYXRlIGlzIHJlcXVpcmVkXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5pc0FsbERheSAmJiAoIXRoaXMuc3RhcnRUaW1lIHx8ICF0aGlzLmVuZFRpbWUpKSB7XG4gICAgICBuZXcgTm90aWNlKFwiXHUyNzRDIFN0YXJ0IGFuZCBlbmQgdGltZXMgYXJlIHJlcXVpcmVkXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIGFjY2VzcyB0b2tlbiBleGlzdHNcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmFjY2Vzc1Rva2VuKSB7XG4gICAgICBuZXcgTm90aWNlKFwiXHUyNzRDIE5vdCBhdXRoZW50aWNhdGVkLiBQbGVhc2UgY29ubmVjdCB5b3VyIEdvb2dsZSBhY2NvdW50IGluIHNldHRpbmdzLlwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB0b2tlbiBoYXMgZXhwaXJlZFxuICAgIGlmIChUb2tlbk1hbmFnZXIuaXNUb2tlbkV4cGlyZWQodGhpcy5wbHVnaW4uc2V0dGluZ3MudG9rZW5FeHBpcnlEYXRlKSkge1xuICAgICAgbmV3IE5vdGljZShcIlx1Mjc0QyBBY2Nlc3MgdG9rZW4gaGFzIGV4cGlyZWQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBHb29nbGUgYWNjb3VudCBpbiBzZXR0aW5ncy5cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEJ1aWxkIGV2ZW50IG9iamVjdFxuICAgICAgY29uc3QgZXZlbnQ6IGFueSA9IHtcbiAgICAgICAgc3VtbWFyeTogdGhpcy50aXRsZS50cmltKCksXG4gICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLnRyaW0oKSB8fCB1bmRlZmluZWQsXG4gICAgICB9O1xuXG4gICAgICBpZiAodGhpcy5pc0FsbERheSkge1xuICAgICAgICAvLyBBbGwtZGF5IGV2ZW50XG4gICAgICAgIGV2ZW50LnN0YXJ0ID0ge1xuICAgICAgICAgIGRhdGU6IHRoaXMuZGF0ZSxcbiAgICAgICAgICB0aW1lWm9uZTogSW50bC5EYXRlVGltZUZvcm1hdCgpLnJlc29sdmVkT3B0aW9ucygpLnRpbWVab25lLFxuICAgICAgICB9O1xuICAgICAgICBldmVudC5lbmQgPSB7XG4gICAgICAgICAgZGF0ZTogdGhpcy5kYXRlLFxuICAgICAgICAgIHRpbWVab25lOiBJbnRsLkRhdGVUaW1lRm9ybWF0KCkucmVzb2x2ZWRPcHRpb25zKCkudGltZVpvbmUsXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUaW1lZCBldmVudFxuICAgICAgICBjb25zdCBzdGFydERhdGVUaW1lID0gYCR7dGhpcy5kYXRlfVQke3RoaXMuc3RhcnRUaW1lfTowMGA7XG4gICAgICAgIGNvbnN0IGVuZERhdGVUaW1lID0gYCR7dGhpcy5kYXRlfVQke3RoaXMuZW5kVGltZX06MDBgO1xuXG4gICAgICAgIGV2ZW50LnN0YXJ0ID0ge1xuICAgICAgICAgIGRhdGVUaW1lOiBzdGFydERhdGVUaW1lLFxuICAgICAgICAgIHRpbWVab25lOiBJbnRsLkRhdGVUaW1lRm9ybWF0KCkucmVzb2x2ZWRPcHRpb25zKCkudGltZVpvbmUsXG4gICAgICAgIH07XG4gICAgICAgIGV2ZW50LmVuZCA9IHtcbiAgICAgICAgICBkYXRlVGltZTogZW5kRGF0ZVRpbWUsXG4gICAgICAgICAgdGltZVpvbmU6IEludGwuRGF0ZVRpbWVGb3JtYXQoKS5yZXNvbHZlZE9wdGlvbnMoKS50aW1lWm9uZSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coXCJDcmVhdGluZyBldmVudDpcIiwgZXZlbnQpO1xuXG4gICAgICAvLyBDcmVhdGUgZXZlbnQgdmlhIEFQSVxuICAgICAgY29uc3QgY3JlYXRlZEV2ZW50ID0gYXdhaXQgR29vZ2xlQ2FsZW5kYXJBUEkuY3JlYXRlRXZlbnQoXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFjY2Vzc1Rva2VuLFxuICAgICAgICBldmVudCxcbiAgICAgICAgXCJwcmltYXJ5XCIsXG4gICAgICApO1xuXG4gICAgICBjb25zb2xlLmxvZyhcIkV2ZW50IGNyZWF0ZWQ6XCIsIGNyZWF0ZWRFdmVudCk7XG5cbiAgICAgIC8vIEdldCB0aGUgZXZlbnQgbGlua1xuICAgICAgY29uc3QgZXZlbnRMaW5rID1cbiAgICAgICAgY3JlYXRlZEV2ZW50Lmh0bWxMaW5rIHx8XG4gICAgICAgIGBodHRwczovL2NhbGVuZGFyLmdvb2dsZS5jb20vY2FsZW5kYXIvZXZlbnQ/ZWlkPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGNyZWF0ZWRFdmVudC5pZCl9YDtcblxuICAgICAgLy8gU3VjY2VzcyFcbiAgICAgIG5ldyBOb3RpY2UoYFx1MjcwNSBFdmVudCBcIiR7dGhpcy50aXRsZX1cIiBjcmVhdGVkIHN1Y2Nlc3NmdWxseSFgKTtcblxuICAgICAgLy8gQ2FsbCB0aGUgY2FsbGJhY2sgd2l0aCBldmVudCBkYXRhXG4gICAgICB0aGlzLm9uU3VibWl0KHtcbiAgICAgICAgdGl0bGU6IHRoaXMudGl0bGUsXG4gICAgICAgIGxpbms6IGV2ZW50TGluayxcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBldmVudDpcIiwgZXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3JcIjtcbiAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBGYWlsZWQgdG8gY3JlYXRlIGV2ZW50OiAke2Vycm9yTWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICBvbkNsb3NlKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgRG9uYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICBzdXBlcihhcHApO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgLy8gQWRkIGN1c3RvbSBjbGFzcyBmb3Igc3R5bGluZ1xuICAgIGNvbnRlbnRFbC5hZGRDbGFzcyhcImRvbmF0aW9uLW1vZGFsXCIpO1xuXG4gICAgLy8gSGVhZGVyXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwge1xuICAgICAgdGV4dDogXCJcdTI3NjRcdUZFMEYgU3VwcG9ydCBEZXZlbG9wbWVudFwiLFxuICAgICAgY2xzOiBcImRvbmF0aW9uLWhlYWRlclwiLFxuICAgIH0pO1xuXG4gICAgLy8gRGVzY3JpcHRpb25cbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiSWYgeW91IGVuam95IHVzaW5nIHRoaXMgcGx1Z2luLCBjb25zaWRlciBzdXBwb3J0aW5nIGl0cyBkZXZlbG9wbWVudCEgWW91ciBzdXBwb3J0IGhlbHBzIGtlZXAgdGhpcyBwcm9qZWN0IGFsaXZlIGFuZCBlbmFibGVzIG5ldyBmZWF0dXJlcy5cIixcbiAgICAgIGNsczogXCJkb25hdGlvbi1kZXNjcmlwdGlvblwiLFxuICAgIH0pO1xuXG4gICAgLy8gQnV5IE1lIGEgQ29mZmVlXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLnNldE5hbWUoXCJcdTI2MTUgQnV5IE1lIGEgQ29mZmVlXCIpXG4gICAgICAuc2V0RGVzYyhcIlN1cHBvcnQgd2l0aCBhIG9uZS10aW1lIGRvbmF0aW9uXCIpXG4gICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgIGJ0blxuICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiRG9uYXRlXCIpXG4gICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgd2luZG93Lm9wZW4oXCJodHRwczovL3d3dy5idXltZWFjb2ZmZWUuY29tL3lvdXJ1c2VybmFtZVwiLCBcIl9ibGFua1wiKTtcbiAgICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAvLyBHaXRIdWIgU3BvbnNvcnMgKG9wdGlvbmFsKVxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKFwiXHUyQjUwIEdpdEh1YiBTcG9uc29yc1wiKVxuICAgICAgLnNldERlc2MoXCJTcG9uc29yIG9uIEdpdEh1YiBmb3IgcmVjdXJyaW5nIHN1cHBvcnRcIilcbiAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoXCJCZWNvbWUgYSBTcG9uc29yXCIpLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHdpbmRvdy5vcGVuKFwiaHR0cHM6Ly9naXRodWIuY29tL3Nwb25zb3JzL3lvdXJ1c2VybmFtZVwiLCBcIl9ibGFua1wiKTtcbiAgICAgICAgfSksXG4gICAgICApO1xuXG4gICAgLy8gVGhhbmsgeW91IG1lc3NhZ2VcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiVGhhbmsgeW91IGZvciB5b3VyIHN1cHBvcnQhIEV2ZXJ5IGNvbnRyaWJ1dGlvbiBoZWxwcyBpbXByb3ZlIHRoaXMgcGx1Z2luLiBcdUQ4M0RcdURFNEZcIixcbiAgICAgIGNsczogXCJkb25hdGlvbi10aGFua3NcIixcbiAgICB9KTtcblxuICAgIC8vIENsb3NlIGJ1dHRvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbCkuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICBidG4uc2V0QnV0dG9uVGV4dChcIkNsb3NlXCIpLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgb25DbG9zZSgpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FDQ0EsSUFBQUEsbUJBQStDOzs7QUNPeEMsSUFBTSwwQkFBa0Q7QUFBQSxFQUM3RCxVQUFVO0FBQUEsRUFDVixhQUFhO0FBQUEsRUFDYixhQUFhO0FBQUEsRUFDYixpQkFBaUI7QUFBQSxFQUNqQixXQUFXO0FBQ2I7QUFTTyxJQUFNLHVCQUEwRDtBQUFBLEVBQ3JFLFNBQVM7QUFBQSxFQUNULFVBQVU7QUFBQSxFQUNWLFdBQVc7QUFBQSxFQUNYLFdBQVc7QUFBQSxFQUNYLFdBQVc7QUFDYjtBQUVPLElBQU0sNEJBQ1g7OztBQzVCRixzQkFBdUI7QUFHaEIsSUFBTSxhQUFOLE1BQWlCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVl0QixPQUFPLGtCQUFrQixVQUF3QjtBQUMvQyxRQUFJLENBQUMsWUFBWSxTQUFTLEtBQUssTUFBTSxJQUFJO0FBQ3ZDLFVBQUksdUJBQU8sa0NBQWtDO0FBQzdDO0FBQUEsSUFDRjtBQUVBLFVBQU0sVUFBVSxLQUFLLGFBQWEsUUFBUTtBQUUxQyxRQUFJLHVCQUFPLGtDQUFr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QUdGLGNBQVUsU0FBUyxLQUFLO0FBQUEsTUFDdEIsTUFBTTtBQUFBLE1BQ04sS0FBSztBQUFBLElBQ1AsQ0FBQztBQUdELFFBQUkseUJBQVEsU0FBUyxFQUFFO0FBQUEsTUFBVSxDQUFDLFFBQ2hDLElBQUksY0FBYyxPQUFPLEVBQUUsUUFBUSxNQUFNO0FBQ3ZDLGFBQUssTUFBTTtBQUFBLE1BQ2IsQ0FBQztBQUFBLElBQ0g7QUFBQSxFQUNGO0FBQUEsRUFFQSxVQUFVO0FBQ1IsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFBQSxFQUNsQjtBQUNGOzs7QVR6REEsSUFBcUIsWUFBckIsY0FBdUMsd0JBQU87QUFBQSxFQUE5QztBQUFBO0FBRUUsc0JBQXNDO0FBQ3RDLDRCQUFpRDtBQUFBO0FBQUEsRUFFakQsTUFBTSxTQUFTO0FBQ2IsVUFBTSxLQUFLLGFBQWE7QUFHeEIsU0FBSyxhQUFhLElBQUksaUJBQWlCLEtBQUssS0FBSyxJQUFJO0FBQ3JELFNBQUssY0FBYyxLQUFLLFVBQVU7QUFHbEMsU0FBSztBQUFBLE1BQ0g7QUFBQSxNQUNBO0FBQUEsTUFDQSxDQUFDLFFBQW9CO0FBQ25CLFlBQUksY0FBYyxLQUFLLEdBQUcsRUFBRSxLQUFLO0FBQUEsTUFDbkM7QUFBQSxJQUNGO0FBR0EsU0FBSyxnQ0FBZ0Msc0JBQXNCLE9BQU8sU0FBUztBQWhDL0U7QUFpQ00sWUFBTSxRQUFRLEtBQUs7QUFFbkIsVUFBSSxPQUFPO0FBQ1QsYUFBSyxTQUFTLGNBQWM7QUFDNUIsY0FBTSxLQUFLLGFBQWE7QUFDeEIsbUJBQUssZUFBTCxtQkFBaUI7QUFDakIsWUFBSSx3QkFBTyxtQ0FBOEI7QUFBQSxNQUMzQyxPQUFPO0FBQ0wsWUFBSTtBQUFBLFVBQ0YsNkJBQXdCLEtBQUssU0FBUyw0QkFBNEI7QUFBQSxRQUNwRTtBQUFBLE1BQ0Y7QUFBQSxJQUNGLENBQUM7QUFHRCxTQUFLLG1CQUFtQixJQUFJLHNCQUFzQixLQUFLLEtBQUssSUFBSTtBQUNoRSxTQUFLLHNCQUFzQixLQUFLLGdCQUFnQjtBQUFBLEVBQ2xEO0FBQUEsRUFFQSxXQUFXO0FBQUEsRUFBQztBQUFBLEVBRVosTUFBTSxlQUFlO0FBQ25CLFNBQUssV0FBVyxPQUFPO0FBQUEsTUFDckIsQ0FBQztBQUFBLE1BQ0Q7QUFBQSxNQUNDLE1BQU0sS0FBSyxTQUFTO0FBQUEsSUFDdkI7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDbkIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDbkM7QUFDRjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAiX2IiLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
